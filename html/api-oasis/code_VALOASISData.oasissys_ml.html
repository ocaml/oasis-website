<html><head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="FormatExt" rel="Chapter" href="FormatExt.html">
<link title="FormatMarkdown" rel="Chapter" href="FormatMarkdown.html">
<link title="ODNFunc" rel="Chapter" href="ODNFunc.html">
<link title="PropList" rel="Chapter" href="PropList.html">
<link title="OASISUtils" rel="Chapter" href="OASISUtils.html">
<link title="OASISUnixPath" rel="Chapter" href="OASISUnixPath.html">
<link title="OASISContext" rel="Chapter" href="OASISContext.html">
<link title="OASISGettext" rel="Chapter" href="OASISGettext.html">
<link title="OASISMessage" rel="Chapter" href="OASISMessage.html">
<link title="OASISTypes" rel="Chapter" href="OASISTypes.html">
<link title="OASISParse" rel="Chapter" href="OASISParse.html">
<link title="OASISValues" rel="Chapter" href="OASISValues.html">
<link title="OASISExpr" rel="Chapter" href="OASISExpr.html">
<link title="OASISVersion" rel="Chapter" href="OASISVersion.html">
<link title="OASISLicense" rel="Chapter" href="OASISLicense.html">
<link title="OASISFileTemplate" rel="Chapter" href="OASISFileTemplate.html">
<link title="OASISBuildSection" rel="Chapter" href="OASISBuildSection.html">
<link title="OASISDocument" rel="Chapter" href="OASISDocument.html">
<link title="OASISExecutable" rel="Chapter" href="OASISExecutable.html">
<link title="OASISFlag" rel="Chapter" href="OASISFlag.html">
<link title="OASISLibrary" rel="Chapter" href="OASISLibrary.html">
<link title="OASISObject" rel="Chapter" href="OASISObject.html">
<link title="OASISPackage" rel="Chapter" href="OASISPackage.html">
<link title="OASISSourceRepository" rel="Chapter" href="OASISSourceRepository.html">
<link title="OASISTest" rel="Chapter" href="OASISTest.html">
<link title="OASISPlugin" rel="Chapter" href="OASISPlugin.html">
<link title="OASISFindlib" rel="Chapter" href="OASISFindlib.html">
<link title="OASISSchema" rel="Chapter" href="OASISSchema.html">
<link title="OASISSection" rel="Chapter" href="OASISSection.html">
<link title="OASISData" rel="Chapter" href="OASISData.html">
<link title="OASISString" rel="Chapter" href="OASISString.html">
<link title="OASISExec" rel="Chapter" href="OASISExec.html">
<link title="OASISFileUtil" rel="Chapter" href="OASISFileUtil.html">
<link title="OASISHostPath" rel="Chapter" href="OASISHostPath.html">
<link title="OASISGraph" rel="Chapter" href="OASISGraph.html">
<link title="BaseArgExt" rel="Chapter" href="BaseArgExt.html">
<link title="BaseBuilt" rel="Chapter" href="BaseBuilt.html">
<link title="BaseCheck" rel="Chapter" href="BaseCheck.html">
<link title="BaseCustom" rel="Chapter" href="BaseCustom.html">
<link title="BaseData" rel="Chapter" href="BaseData.html">
<link title="BaseDoc" rel="Chapter" href="BaseDoc.html">
<link title="BaseEnvLight" rel="Chapter" href="BaseEnvLight.html">
<link title="BaseEnv" rel="Chapter" href="BaseEnv.html">
<link title="BaseFileAB" rel="Chapter" href="BaseFileAB.html">
<link title="BaseGenerate" rel="Chapter" href="BaseGenerate.html">
<link title="BaseLog" rel="Chapter" href="BaseLog.html">
<link title="BaseOCamlcConfig" rel="Chapter" href="BaseOCamlcConfig.html">
<link title="BaseSetup" rel="Chapter" href="BaseSetup.html">
<link title="BaseStandardVar" rel="Chapter" href="BaseStandardVar.html">
<link title="BaseTest" rel="Chapter" href="BaseTest.html">
<link title="BaseDynVar" rel="Chapter" href="BaseDynVar.html">
<link title="BaseMessage" rel="Chapter" href="BaseMessage.html">
<link title="BaseContext" rel="Chapter" href="BaseContext.html">
<link title="SubCommand" rel="Chapter" href="SubCommand.html">
<link title="ArgExt" rel="Chapter" href="ArgExt.html">
<link title="Pager" rel="Chapter" href="Pager.html"><title>OASISData.oasissys_ml</title>
</head>
<body>
<code class="code"><span class="keyword">let</span>&nbsp;oasissys_ml&nbsp;=&nbsp;<br>
&nbsp;&nbsp;<span class="string">"module&nbsp;OASISGettext&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISGettext.ml\"\n\n\&nbsp;&nbsp;let&nbsp;ns_&nbsp;str&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;str\n\n\&nbsp;&nbsp;let&nbsp;s_&nbsp;str&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;str\n\n\&nbsp;&nbsp;let&nbsp;f_&nbsp;(str&nbsp;:&nbsp;('a,&nbsp;'b,&nbsp;'c,&nbsp;'d)&nbsp;format4)&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;str\n\n\&nbsp;&nbsp;let&nbsp;fn_&nbsp;fmt1&nbsp;fmt2&nbsp;n&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;=&nbsp;1&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fmt1^^\"\"\n\&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fmt2^^\"\"\n\n\&nbsp;&nbsp;let&nbsp;init&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;[]\n\nend\n\nmodule&nbsp;OASISContext&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISContext.ml\"\n\n\&nbsp;&nbsp;open&nbsp;OASISGettext\n\n\&nbsp;&nbsp;type&nbsp;level&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;`Debug\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Info\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Warning\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Error]\n\n\&nbsp;&nbsp;type&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiet:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;info:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ignore_plugins:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ignore_unknown_fields:&nbsp;bool;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;level&nbsp;-&gt;&nbsp;string&nbsp;-&gt;&nbsp;unit;\n\&nbsp;&nbsp;&nbsp;&nbsp;}\n\n\&nbsp;&nbsp;let&nbsp;printf&nbsp;lvl&nbsp;str&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;beg&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;lvl&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Error&nbsp;-&gt;&nbsp;s_&nbsp;\"E:&nbsp;\"\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Warning&nbsp;-&gt;&nbsp;s_&nbsp;\"W:&nbsp;\"\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Info&nbsp;&nbsp;-&gt;&nbsp;s_&nbsp;\"I:&nbsp;\"\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Debug&nbsp;-&gt;&nbsp;s_&nbsp;\"D:&nbsp;\"\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prerr_endline&nbsp;(beg^str)\n\n\&nbsp;&nbsp;let&nbsp;default&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;ref\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;false;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;info&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;false;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;false;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ignore_plugins&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;false;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ignore_unknown_fields&nbsp;=&nbsp;false;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;printf;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n\&nbsp;&nbsp;let&nbsp;quiet&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;{!default&nbsp;with&nbsp;quiet&nbsp;=&nbsp;true}\n\n\n\&nbsp;&nbsp;let&nbsp;args&nbsp;()&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;[\"-quiet\",\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arg.Unit&nbsp;(fun&nbsp;()&nbsp;-&gt;&nbsp;default&nbsp;:=&nbsp;{!default&nbsp;with&nbsp;quiet&nbsp;=&nbsp;true}),\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(s_&nbsp;\"&nbsp;Run&nbsp;quietly\");\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\"-info\",\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arg.Unit&nbsp;(fun&nbsp;()&nbsp;-&gt;&nbsp;default&nbsp;:=&nbsp;{!default&nbsp;with&nbsp;info&nbsp;=&nbsp;true}),\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(s_&nbsp;\"&nbsp;Display&nbsp;information&nbsp;message\");\n\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\"-debug\",\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arg.Unit&nbsp;(fun&nbsp;()&nbsp;-&gt;&nbsp;default&nbsp;:=&nbsp;{!default&nbsp;with&nbsp;debug&nbsp;=&nbsp;true}),\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(s_&nbsp;\"&nbsp;Output&nbsp;debug&nbsp;message\")]\nend\n\nmodule&nbsp;OASISString&nbsp;=&nbsp;struct\n#&nbsp;1&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISString.ml\"\n\n\n\n\&nbsp;&nbsp;(**&nbsp;Various&nbsp;string&nbsp;utilities.\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mostly&nbsp;inspired&nbsp;by&nbsp;extlib&nbsp;and&nbsp;batteries&nbsp;ExtString&nbsp;and&nbsp;BatString&nbsp;libraries.\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@author&nbsp;Sylvain&nbsp;Le&nbsp;Gall\n\&nbsp;&nbsp;&nbsp;&nbsp;*)\n\n\&nbsp;&nbsp;let&nbsp;nsplitf&nbsp;str&nbsp;f&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;str&nbsp;=&nbsp;\"\"&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]\n\&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;buf&nbsp;=&nbsp;Buffer.create&nbsp;13&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;lst&nbsp;=&nbsp;ref&nbsp;[]&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;push&nbsp;()&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lst&nbsp;:=&nbsp;Buffer.contents&nbsp;buf&nbsp;::&nbsp;!lst;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Buffer.clear&nbsp;buf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;str_len&nbsp;=&nbsp;String.length&nbsp;str&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;=&nbsp;0&nbsp;to&nbsp;str_len&nbsp;-&nbsp;1&nbsp;do\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;f&nbsp;str.[i]&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;()\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Buffer.add_char&nbsp;buf&nbsp;str.[i]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;();\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.rev&nbsp;!lst\n\n\&nbsp;&nbsp;(**&nbsp;[nsplit&nbsp;c&nbsp;s]&nbsp;Split&nbsp;the&nbsp;string&nbsp;[s]&nbsp;at&nbsp;char&nbsp;[c].&nbsp;It&nbsp;doesn't&nbsp;include&nbsp;the\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;separator.\n\&nbsp;&nbsp;&nbsp;&nbsp;*)\n\&nbsp;&nbsp;let&nbsp;nsplit&nbsp;str&nbsp;c&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;nsplitf&nbsp;str&nbsp;((=)&nbsp;c)\n\n\&nbsp;&nbsp;let&nbsp;find&nbsp;~what&nbsp;?(offset=0)&nbsp;str&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;what_idx&nbsp;=&nbsp;ref&nbsp;0&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;str_idx&nbsp;=&nbsp;ref&nbsp;offset&nbsp;in&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;!str_idx&nbsp;&lt;&nbsp;String.length&nbsp;str&nbsp;&amp;&amp;&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!what_idx&nbsp;&lt;&nbsp;String.length&nbsp;what&nbsp;do\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;str.[!str_idx]&nbsp;=&nbsp;what.[!what_idx]&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incr&nbsp;what_idx\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;what_idx&nbsp;:=&nbsp;0;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incr&nbsp;str_idx\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;!what_idx&nbsp;&lt;&gt;&nbsp;String.length&nbsp;what&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;Not_found\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!str_idx&nbsp;-&nbsp;!what_idx\n\n\&nbsp;&nbsp;let&nbsp;sub_start&nbsp;str&nbsp;len&nbsp;=&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;str_len&nbsp;=&nbsp;String.length&nbsp;str&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len&nbsp;&gt;=&nbsp;str_len&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\"\"\n\&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.sub&nbsp;str&nbsp;len&nbsp;(str_len&nbsp;-&nbsp;len)\n\n\&nbsp;&nbsp;let&nbsp;sub_end&nbsp;?(offset=0)&nbsp;str&nbsp;len&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;str_len&nbsp;=&nbsp;String.length&nbsp;str&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len&nbsp;&gt;=&nbsp;str_len&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\"\"\n\&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.sub&nbsp;str&nbsp;0&nbsp;(str_len&nbsp;-&nbsp;len)\n\n\&nbsp;&nbsp;let&nbsp;starts_with&nbsp;~what&nbsp;?(offset=0)&nbsp;str&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;what_idx&nbsp;=&nbsp;ref&nbsp;0&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;str_idx&nbsp;=&nbsp;ref&nbsp;offset&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;ok&nbsp;=&nbsp;ref&nbsp;true&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;!ok&nbsp;&amp;&amp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!str_idx&nbsp;&lt;&nbsp;String.length&nbsp;str&nbsp;&amp;&amp;&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!what_idx&nbsp;&lt;&nbsp;String.length&nbsp;what&nbsp;do\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;str.[!str_idx]&nbsp;=&nbsp;what.[!what_idx]&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incr&nbsp;what_idx\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;:=&nbsp;false;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incr&nbsp;str_idx\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;!what_idx&nbsp;=&nbsp;String.length&nbsp;what&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;true\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false\n\n\&nbsp;&nbsp;let&nbsp;strip_starts_with&nbsp;~what&nbsp;str&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;starts_with&nbsp;~what&nbsp;str&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_start&nbsp;str&nbsp;(String.length&nbsp;what)\n\&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;Not_found\n\n\&nbsp;&nbsp;let&nbsp;ends_with&nbsp;~what&nbsp;?(offset=0)&nbsp;str&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;what_idx&nbsp;=&nbsp;ref&nbsp;((String.length&nbsp;what)&nbsp;-&nbsp;1)&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;str_idx&nbsp;=&nbsp;ref&nbsp;((String.length&nbsp;str)&nbsp;-&nbsp;1)&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;ok&nbsp;=&nbsp;ref&nbsp;true&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;!ok&nbsp;&amp;&amp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offset&nbsp;&lt;=&nbsp;!str_idx&nbsp;&amp;&amp;&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&lt;=&nbsp;!what_idx&nbsp;do\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;str.[!str_idx]&nbsp;=&nbsp;what.[!what_idx]&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decr&nbsp;what_idx\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;:=&nbsp;false;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decr&nbsp;str_idx\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;!what_idx&nbsp;=&nbsp;-1&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;true\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false\n\n\&nbsp;&nbsp;let&nbsp;strip_ends_with&nbsp;~what&nbsp;str&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ends_with&nbsp;~what&nbsp;str&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_end&nbsp;str&nbsp;(String.length&nbsp;what)\n\&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;Not_found\n\n\&nbsp;&nbsp;let&nbsp;replace_chars&nbsp;f&nbsp;s&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;buf&nbsp;=&nbsp;String.make&nbsp;(String.length&nbsp;s)&nbsp;'X'&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;=&nbsp;0&nbsp;to&nbsp;String.length&nbsp;s&nbsp;-&nbsp;1&nbsp;do\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf.[i]&nbsp;&lt;-&nbsp;f&nbsp;s.[i]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf\n\nend\n\nmodule&nbsp;OASISUtils&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISUtils.ml\"\n\n\&nbsp;&nbsp;open&nbsp;OASISGettext\n\n\&nbsp;&nbsp;module&nbsp;MapString&nbsp;=&nbsp;Map.Make(String)\n\n\&nbsp;&nbsp;let&nbsp;map_string_of_assoc&nbsp;assoc&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;List.fold_left\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;acc&nbsp;(k,&nbsp;v)&nbsp;-&gt;&nbsp;MapString.add&nbsp;k&nbsp;v&nbsp;acc)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MapString.empty\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assoc\n\n\&nbsp;&nbsp;module&nbsp;SetString&nbsp;=&nbsp;Set.Make(String)\n\n\&nbsp;&nbsp;let&nbsp;set_string_add_list&nbsp;st&nbsp;lst&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;List.fold_left\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;acc&nbsp;e&nbsp;-&gt;&nbsp;SetString.add&nbsp;e&nbsp;acc)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;st\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lst\n\n\&nbsp;&nbsp;let&nbsp;set_string_of_list&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;set_string_add_list\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetString.empty\n\n\n\&nbsp;&nbsp;let&nbsp;compare_csl&nbsp;s1&nbsp;s2&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;String.compare&nbsp;(String.lowercase&nbsp;s1)&nbsp;(String.lowercase&nbsp;s2)\n\n\&nbsp;&nbsp;module&nbsp;HashStringCsl&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;Hashtbl.Make\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(struct\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;t&nbsp;=&nbsp;string\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;equal&nbsp;s1&nbsp;s2&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(String.lowercase&nbsp;s1)&nbsp;=&nbsp;(String.lowercase&nbsp;s2)\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;hash&nbsp;s&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hashtbl.hash&nbsp;(String.lowercase&nbsp;s)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end)\n\n\&nbsp;&nbsp;let&nbsp;varname_of_string&nbsp;?(hyphen='_')&nbsp;s&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;String.length&nbsp;s&nbsp;=&nbsp;0&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invalid_arg&nbsp;\"varname_of_string\"\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;buf&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISString.replace_chars\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;c&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;('a'&nbsp;&lt;=&nbsp;c&nbsp;&amp;&amp;&nbsp;c&nbsp;&lt;=&nbsp;'z')\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;('A'&nbsp;&lt;=&nbsp;c&nbsp;&amp;&amp;&nbsp;c&nbsp;&lt;=&nbsp;'Z')\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;('0'&nbsp;&lt;=&nbsp;c&nbsp;&amp;&amp;&nbsp;c&nbsp;&lt;=&nbsp;'9')&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hyphen)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;buf&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Start&nbsp;with&nbsp;a&nbsp;_&nbsp;if&nbsp;digit&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;'0'&nbsp;&lt;=&nbsp;s.[0]&nbsp;&amp;&amp;&nbsp;s.[0]&nbsp;&lt;=&nbsp;'9'&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\"_\"^buf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.lowercase&nbsp;buf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\n\&nbsp;&nbsp;let&nbsp;varname_concat&nbsp;?(hyphen='_')&nbsp;p&nbsp;s&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;what&nbsp;=&nbsp;String.make&nbsp;1&nbsp;hyphen&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;p&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISString.strip_ends_with&nbsp;~what&nbsp;p\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Not_found&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;s&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISString.strip_starts_with&nbsp;~what&nbsp;s\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Not_found&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p^what^s\n\n\n\&nbsp;&nbsp;let&nbsp;is_varname&nbsp;str&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;str&nbsp;=&nbsp;varname_of_string&nbsp;str\n\n\&nbsp;&nbsp;let&nbsp;failwithf&nbsp;fmt&nbsp;=&nbsp;Printf.ksprintf&nbsp;failwith&nbsp;fmt\n\nend\n\nmodule&nbsp;PropList&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/PropList.ml\"\n\n\&nbsp;&nbsp;open&nbsp;OASISGettext\n\n\&nbsp;&nbsp;type&nbsp;name&nbsp;=&nbsp;string\n\n\&nbsp;&nbsp;exception&nbsp;Not_set&nbsp;of&nbsp;name&nbsp;*&nbsp;string&nbsp;option\n\&nbsp;&nbsp;exception&nbsp;No_printer&nbsp;of&nbsp;name\n\&nbsp;&nbsp;exception&nbsp;Unknown_field&nbsp;of&nbsp;name&nbsp;*&nbsp;name\n\n\&nbsp;&nbsp;let&nbsp;()&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;Printexc.register_printer\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(function\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Not_set&nbsp;(nm,&nbsp;Some&nbsp;rsn)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Printf.sprintf&nbsp;(f_&nbsp;\"Field&nbsp;'%s'&nbsp;is&nbsp;not&nbsp;set:&nbsp;%s\")&nbsp;nm&nbsp;rsn)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Not_set&nbsp;(nm,&nbsp;None)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Printf.sprintf&nbsp;(f_&nbsp;\"Field&nbsp;'%s'&nbsp;is&nbsp;not&nbsp;set\")&nbsp;nm)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;No_printer&nbsp;nm&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Some\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Printf.sprintf&nbsp;(f_&nbsp;\"No&nbsp;default&nbsp;printer&nbsp;for&nbsp;value&nbsp;%s\")&nbsp;nm)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Unknown_field&nbsp;(nm,&nbsp;schm)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Printf.sprintf&nbsp;(f_&nbsp;\"Field&nbsp;%s&nbsp;is&nbsp;not&nbsp;defined&nbsp;in&nbsp;schema&nbsp;%s\")&nbsp;nm&nbsp;schm)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None)\n\n\&nbsp;&nbsp;module&nbsp;Data&nbsp;=\n\&nbsp;&nbsp;struct\n\n\&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(name,&nbsp;unit&nbsp;-&gt;&nbsp;unit)&nbsp;Hashtbl.t\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;create&nbsp;()&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hashtbl.create&nbsp;13\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;clear&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hashtbl.clear&nbsp;t\n\n#&nbsp;71&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/PropList.ml\"\n\&nbsp;&nbsp;end\n\n\&nbsp;&nbsp;module&nbsp;Schema&nbsp;=\n\&nbsp;&nbsp;struct\n\n\&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;('ctxt,&nbsp;'extra)&nbsp;value&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get:&nbsp;&nbsp;&nbsp;Data.t&nbsp;-&gt;&nbsp;string;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set:&nbsp;&nbsp;&nbsp;Data.t&nbsp;-&gt;&nbsp;?context:'ctxt&nbsp;-&gt;&nbsp;string&nbsp;-&gt;&nbsp;unit;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help:&nbsp;&nbsp;(unit&nbsp;-&gt;&nbsp;string)&nbsp;option;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extra:&nbsp;'extra;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n\&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;('ctxt,&nbsp;'extra)&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fields:&nbsp;&nbsp;&nbsp;&nbsp;(name,&nbsp;('ctxt,&nbsp;'extra)&nbsp;value)&nbsp;Hashtbl.t;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;order:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;Queue.t;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_norm:&nbsp;string&nbsp;-&gt;&nbsp;string;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;create&nbsp;?(case_insensitive=false)&nbsp;nm&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;nm;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fields&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;Hashtbl.create&nbsp;13;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;order&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;Queue.create&nbsp;();\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_norm&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(if&nbsp;case_insensitive&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.lowercase\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;s&nbsp;-&gt;&nbsp;s);\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;add&nbsp;t&nbsp;nm&nbsp;set&nbsp;get&nbsp;extra&nbsp;help&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;key&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.name_norm&nbsp;nm\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Hashtbl.mem&nbsp;t.fields&nbsp;key&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;failwith\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Printf.sprintf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f_&nbsp;\"Field&nbsp;'%s'&nbsp;is&nbsp;already&nbsp;defined&nbsp;in&nbsp;schema&nbsp;'%s'\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nm&nbsp;t.name);\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hashtbl.add\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.fields\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&nbsp;&nbsp;=&nbsp;set;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get&nbsp;&nbsp;&nbsp;=&nbsp;get;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help&nbsp;&nbsp;=&nbsp;help;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extra&nbsp;=&nbsp;extra;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Queue.add&nbsp;nm&nbsp;t.order\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;mem&nbsp;t&nbsp;nm&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hashtbl.mem&nbsp;t.fields&nbsp;nm\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;find&nbsp;t&nbsp;nm&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hashtbl.find&nbsp;t.fields&nbsp;(t.name_norm&nbsp;nm)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Not_found&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;(Unknown_field&nbsp;(nm,&nbsp;t.name))\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;get&nbsp;t&nbsp;data&nbsp;nm&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(find&nbsp;t&nbsp;nm).get&nbsp;data\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;set&nbsp;t&nbsp;data&nbsp;nm&nbsp;?context&nbsp;x&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(find&nbsp;t&nbsp;nm).set\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?context\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;fold&nbsp;f&nbsp;acc&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Queue.fold\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;acc&nbsp;k&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;v&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;find&nbsp;t&nbsp;k\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;acc&nbsp;k&nbsp;v.extra&nbsp;v.help)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acc\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.order\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;iter&nbsp;f&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fold\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;()&nbsp;-&gt;&nbsp;f)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;()\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;name&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.name\n\&nbsp;&nbsp;end\n\n\&nbsp;&nbsp;module&nbsp;Field&nbsp;=\n\&nbsp;&nbsp;struct\n\n\&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;('ctxt,&nbsp;'value,&nbsp;'extra)&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set:&nbsp;&nbsp;&nbsp;&nbsp;Data.t&nbsp;-&gt;&nbsp;?context:'ctxt&nbsp;-&gt;&nbsp;'value&nbsp;-&gt;&nbsp;unit;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get:&nbsp;&nbsp;&nbsp;&nbsp;Data.t&nbsp;-&gt;&nbsp;'value;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sets:&nbsp;&nbsp;&nbsp;Data.t&nbsp;-&gt;&nbsp;?context:'ctxt&nbsp;-&gt;&nbsp;string&nbsp;-&gt;&nbsp;unit;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gets:&nbsp;&nbsp;&nbsp;Data.t&nbsp;-&gt;&nbsp;string;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help:&nbsp;&nbsp;&nbsp;(unit&nbsp;-&gt;&nbsp;string)&nbsp;option;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extra:&nbsp;&nbsp;'extra;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;new_id&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;last_id&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ref&nbsp;0\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;()&nbsp;-&gt;&nbsp;incr&nbsp;last_id;&nbsp;!last_id\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;create&nbsp;?schema&nbsp;?name&nbsp;?parse&nbsp;?print&nbsp;?default&nbsp;?update&nbsp;?help&nbsp;extra&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Default&nbsp;value&nbsp;container&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;v&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ref&nbsp;None\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;If&nbsp;name&nbsp;is&nbsp;not&nbsp;given,&nbsp;create&nbsp;unique&nbsp;one&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;nm&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;name&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;s&nbsp;-&gt;&nbsp;s\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;-&gt;&nbsp;Printf.sprintf&nbsp;\"_anon_%d\"&nbsp;(new_id&nbsp;())\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Last&nbsp;chance&nbsp;to&nbsp;get&nbsp;a&nbsp;value:&nbsp;the&nbsp;default&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;default&nbsp;()&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;default&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;d&nbsp;-&gt;&nbsp;d\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;-&gt;&nbsp;raise&nbsp;(Not_set&nbsp;(nm,&nbsp;Some&nbsp;(s_&nbsp;\"no&nbsp;default&nbsp;value\")))\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Get&nbsp;data&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;get&nbsp;data&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Get&nbsp;value&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Hashtbl.find&nbsp;data&nbsp;nm)&nbsp;();\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;!v&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;x&nbsp;-&gt;&nbsp;x\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;-&gt;&nbsp;default&nbsp;()\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Not_found&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default&nbsp;()\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Set&nbsp;data&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;set&nbsp;data&nbsp;?context&nbsp;x&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;x&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;update&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;f&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;?context&nbsp;(get&nbsp;data)&nbsp;x\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Not_set&nbsp;_&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hashtbl.replace\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nm\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;()&nbsp;-&gt;&nbsp;v&nbsp;:=&nbsp;Some&nbsp;x)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Parse&nbsp;string&nbsp;value,&nbsp;if&nbsp;possible&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;parse&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;parse&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;f&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;?context&nbsp;s&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;failwith\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Printf.sprintf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f_&nbsp;\"Cannot&nbsp;parse&nbsp;field&nbsp;'%s'&nbsp;when&nbsp;setting&nbsp;value&nbsp;%S\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nm\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Set&nbsp;data,&nbsp;from&nbsp;string&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;sets&nbsp;data&nbsp;?context&nbsp;s&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;?context&nbsp;data&nbsp;(parse&nbsp;?context&nbsp;s)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Output&nbsp;value&nbsp;as&nbsp;string,&nbsp;if&nbsp;possible&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;print&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;print&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;f&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;_&nbsp;-&gt;&nbsp;raise&nbsp;(No_printer&nbsp;nm)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Get&nbsp;data,&nbsp;as&nbsp;a&nbsp;string&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;gets&nbsp;data&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;(get&nbsp;data)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;schema&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;t&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Schema.add&nbsp;t&nbsp;nm&nbsp;sets&nbsp;gets&nbsp;extra&nbsp;help\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;()\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end;\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&nbsp;&nbsp;=&nbsp;set;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get&nbsp;&nbsp;&nbsp;=&nbsp;get;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sets&nbsp;&nbsp;=&nbsp;sets;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gets&nbsp;&nbsp;=&nbsp;gets;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help&nbsp;&nbsp;=&nbsp;help;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extra&nbsp;=&nbsp;extra;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;fset&nbsp;data&nbsp;t&nbsp;?context&nbsp;x&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.set&nbsp;data&nbsp;?context&nbsp;x\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;fget&nbsp;data&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.get&nbsp;data\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;fsets&nbsp;data&nbsp;t&nbsp;?context&nbsp;s&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.sets&nbsp;data&nbsp;?context&nbsp;s\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;fgets&nbsp;data&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.gets&nbsp;data\n\n\&nbsp;&nbsp;end\n\n\&nbsp;&nbsp;module&nbsp;FieldRO&nbsp;=\n\&nbsp;&nbsp;struct\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;create&nbsp;?schema&nbsp;?name&nbsp;?parse&nbsp;?print&nbsp;?default&nbsp;?update&nbsp;?help&nbsp;extra&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;fld&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Field.create&nbsp;?schema&nbsp;?name&nbsp;?parse&nbsp;?print&nbsp;?default&nbsp;?update&nbsp;?help&nbsp;extra\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;data&nbsp;-&gt;&nbsp;Field.fget&nbsp;data&nbsp;fld\n\n\&nbsp;&nbsp;end\nend\n\nmodule&nbsp;OASISMessage&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISMessage.ml\"\n\n\n\&nbsp;&nbsp;open&nbsp;OASISGettext\n\&nbsp;&nbsp;open&nbsp;OASISContext\n\n\&nbsp;&nbsp;let&nbsp;generic_message&nbsp;~ctxt&nbsp;lvl&nbsp;fmt&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;cond&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ctxt.quiet&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;lvl&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Debug&nbsp;-&gt;&nbsp;ctxt.debug\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Info&nbsp;&nbsp;-&gt;&nbsp;ctxt.info\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;-&gt;&nbsp;true\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Printf.ksprintf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;str&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;cond&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ctxt.printf&nbsp;lvl&nbsp;str\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fmt\n\n\&nbsp;&nbsp;let&nbsp;debug&nbsp;~ctxt&nbsp;fmt&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;generic_message&nbsp;~ctxt&nbsp;`Debug&nbsp;fmt\n\n\&nbsp;&nbsp;let&nbsp;info&nbsp;~ctxt&nbsp;fmt&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;generic_message&nbsp;~ctxt&nbsp;`Info&nbsp;fmt\n\n\&nbsp;&nbsp;let&nbsp;warning&nbsp;~ctxt&nbsp;fmt&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;generic_message&nbsp;~ctxt&nbsp;`Warning&nbsp;fmt\n\n\&nbsp;&nbsp;let&nbsp;error&nbsp;~ctxt&nbsp;fmt&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;generic_message&nbsp;~ctxt&nbsp;`Error&nbsp;fmt\n\nend\n\nmodule&nbsp;OASISVersion&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISVersion.ml\"\n\n\&nbsp;&nbsp;open&nbsp;OASISGettext\n\n\n\n\&nbsp;&nbsp;type&nbsp;s&nbsp;=&nbsp;string\n\n\&nbsp;&nbsp;type&nbsp;t&nbsp;=&nbsp;string&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;comparator&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VGreater&nbsp;of&nbsp;t\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VGreaterEqual&nbsp;of&nbsp;t\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VEqual&nbsp;of&nbsp;t\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VLesser&nbsp;of&nbsp;t\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VLesserEqual&nbsp;of&nbsp;t\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VOr&nbsp;of&nbsp;&nbsp;comparator&nbsp;*&nbsp;comparator\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VAnd&nbsp;of&nbsp;comparator&nbsp;*&nbsp;comparator\n\&nbsp;&nbsp;&nbsp;&nbsp;\n\n\&nbsp;&nbsp;(*&nbsp;Range&nbsp;of&nbsp;allowed&nbsp;characters&nbsp;*)\n\&nbsp;&nbsp;let&nbsp;is_digit&nbsp;c&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;'0'&nbsp;&lt;=&nbsp;c&nbsp;&amp;&amp;&nbsp;c&nbsp;&lt;=&nbsp;'9'\n\n\&nbsp;&nbsp;let&nbsp;is_alpha&nbsp;c&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;('a'&nbsp;&lt;=&nbsp;c&nbsp;&amp;&amp;&nbsp;c&nbsp;&lt;=&nbsp;'z')&nbsp;||&nbsp;('A'&nbsp;&lt;=&nbsp;c&nbsp;&amp;&amp;&nbsp;c&nbsp;&lt;=&nbsp;'Z')\n\n\&nbsp;&nbsp;let&nbsp;is_special&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;function\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;'.'&nbsp;|&nbsp;'+'&nbsp;|&nbsp;'-'&nbsp;|&nbsp;'~'&nbsp;-&gt;&nbsp;true\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;-&gt;&nbsp;false\n\n\&nbsp;&nbsp;let&nbsp;rec&nbsp;version_compare&nbsp;v1&nbsp;v2&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;v1&nbsp;&lt;&gt;&nbsp;\"\"&nbsp;||&nbsp;v2&nbsp;&lt;&gt;&nbsp;\"\"&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Compare&nbsp;ascii&nbsp;string,&nbsp;using&nbsp;special&nbsp;meaning&nbsp;for&nbsp;version\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;related&nbsp;char\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;val_ascii&nbsp;c&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;c&nbsp;=&nbsp;'~'&nbsp;then&nbsp;-1\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;is_digit&nbsp;c&nbsp;then&nbsp;0\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;c&nbsp;=&nbsp;'\\000'&nbsp;then&nbsp;0\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;is_alpha&nbsp;c&nbsp;then&nbsp;Char.code&nbsp;c\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;(Char.code&nbsp;c)&nbsp;+&nbsp;256\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;len1&nbsp;=&nbsp;String.length&nbsp;v1&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;len2&nbsp;=&nbsp;String.length&nbsp;v2&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;p&nbsp;=&nbsp;ref&nbsp;0&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(**&nbsp;Compare&nbsp;ascii&nbsp;part&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;compare_vascii&nbsp;()&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;cmp&nbsp;=&nbsp;ref&nbsp;0&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;!cmp&nbsp;=&nbsp;0&nbsp;&amp;&amp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!p&nbsp;&lt;&nbsp;len1&nbsp;&amp;&amp;&nbsp;!p&nbsp;&lt;&nbsp;len2&nbsp;&amp;&amp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not&nbsp;(is_digit&nbsp;v1.[!p]&nbsp;&amp;&amp;&nbsp;is_digit&nbsp;v2.[!p])&nbsp;do\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmp&nbsp;:=&nbsp;(val_ascii&nbsp;v1.[!p])&nbsp;-&nbsp;(val_ascii&nbsp;v2.[!p]);\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incr&nbsp;p\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;!cmp&nbsp;=&nbsp;0&nbsp;&amp;&amp;&nbsp;!p&nbsp;&lt;&nbsp;len1&nbsp;&amp;&amp;&nbsp;!p&nbsp;=&nbsp;len2&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val_ascii&nbsp;v1.[!p]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;!cmp&nbsp;=&nbsp;0&nbsp;&amp;&amp;&nbsp;!p&nbsp;=&nbsp;len1&nbsp;&amp;&amp;&nbsp;!p&nbsp;&lt;&nbsp;len2&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;(val_ascii&nbsp;v2.[!p])\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!cmp\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(**&nbsp;Compare&nbsp;digit&nbsp;part&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;compare_digit&nbsp;()&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;extract_int&nbsp;v&nbsp;p&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;start_p&nbsp;=&nbsp;!p&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;!p&nbsp;&lt;&nbsp;String.length&nbsp;v&nbsp;&amp;&amp;&nbsp;is_digit&nbsp;v.[!p]&nbsp;do\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incr&nbsp;p\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;substr&nbsp;=&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.sub&nbsp;v&nbsp;!p&nbsp;((String.length&nbsp;v)&nbsp;-&nbsp;!p)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;res&nbsp;=&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;String.sub&nbsp;v&nbsp;start_p&nbsp;(!p&nbsp;-&nbsp;start_p)&nbsp;with&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;\"\"&nbsp;-&gt;&nbsp;0\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;s&nbsp;-&gt;&nbsp;int_of_string&nbsp;s\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res,&nbsp;substr\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;i1,&nbsp;tl1&nbsp;=&nbsp;extract_int&nbsp;v1&nbsp;(ref&nbsp;!p)&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;i2,&nbsp;tl2&nbsp;=&nbsp;extract_int&nbsp;v2&nbsp;(ref&nbsp;!p)&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i1&nbsp;-&nbsp;i2,&nbsp;tl1,&nbsp;tl2\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;compare_vascii&nbsp;()&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;0&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;compare_digit&nbsp;()&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;0,&nbsp;tl1,&nbsp;tl2&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;tl1&nbsp;&lt;&gt;&nbsp;\"\"&nbsp;&amp;&amp;&nbsp;is_digit&nbsp;tl1.[0]&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;tl2&nbsp;&lt;&gt;&nbsp;\"\"&nbsp;&amp;&amp;&nbsp;is_digit&nbsp;tl2.[0]&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version_compare&nbsp;tl1&nbsp;tl2\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;n,&nbsp;_,&nbsp;_&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;n&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\n\n\&nbsp;&nbsp;let&nbsp;version_of_string&nbsp;str&nbsp;=&nbsp;str\n\n\&nbsp;&nbsp;let&nbsp;string_of_version&nbsp;t&nbsp;=&nbsp;t\n\n\&nbsp;&nbsp;let&nbsp;chop&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;pos&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.rindex&nbsp;t&nbsp;'.'\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.sub&nbsp;t&nbsp;0&nbsp;pos\n\&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Not_found&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t\n\n\&nbsp;&nbsp;let&nbsp;rec&nbsp;comparator_apply&nbsp;v&nbsp;op&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;op&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VGreater&nbsp;cv&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(version_compare&nbsp;v&nbsp;cv)&nbsp;&gt;&nbsp;0\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VGreaterEqual&nbsp;cv&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(version_compare&nbsp;v&nbsp;cv)&nbsp;&gt;=&nbsp;0\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VLesser&nbsp;cv&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(version_compare&nbsp;v&nbsp;cv)&nbsp;&lt;&nbsp;0\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VLesserEqual&nbsp;cv&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(version_compare&nbsp;v&nbsp;cv)&nbsp;&lt;=&nbsp;0\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VEqual&nbsp;cv&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(version_compare&nbsp;v&nbsp;cv)&nbsp;=&nbsp;0\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VOr&nbsp;(op1,&nbsp;op2)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(comparator_apply&nbsp;v&nbsp;op1)&nbsp;||&nbsp;(comparator_apply&nbsp;v&nbsp;op2)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VAnd&nbsp;(op1,&nbsp;op2)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(comparator_apply&nbsp;v&nbsp;op1)&nbsp;&amp;&amp;&nbsp;(comparator_apply&nbsp;v&nbsp;op2)\n\n\&nbsp;&nbsp;let&nbsp;rec&nbsp;string_of_comparator&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;function\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VGreater&nbsp;v&nbsp;&nbsp;-&gt;&nbsp;\"&gt;&nbsp;\"^(string_of_version&nbsp;v)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VEqual&nbsp;v&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;\"=&nbsp;\"^(string_of_version&nbsp;v)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VLesser&nbsp;v&nbsp;&nbsp;&nbsp;-&gt;&nbsp;\"&lt;&nbsp;\"^(string_of_version&nbsp;v)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VGreaterEqual&nbsp;v&nbsp;-&gt;&nbsp;\"&gt;=&nbsp;\"^(string_of_version&nbsp;v)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VLesserEqual&nbsp;v&nbsp;&nbsp;-&gt;&nbsp;\"&lt;=&nbsp;\"^(string_of_version&nbsp;v)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VOr&nbsp;(c1,&nbsp;c2)&nbsp;&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(string_of_comparator&nbsp;c1)^\"&nbsp;||&nbsp;\"^(string_of_comparator&nbsp;c2)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VAnd&nbsp;(c1,&nbsp;c2)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(string_of_comparator&nbsp;c1)^\"&nbsp;&amp;&amp;&nbsp;\"^(string_of_comparator&nbsp;c2)\n\n\&nbsp;&nbsp;let&nbsp;rec&nbsp;varname_of_comparator&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;concat&nbsp;p&nbsp;v&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISUtils.varname_concat\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(OASISUtils.varname_of_string\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(string_of_version&nbsp;v))\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VGreater&nbsp;v&nbsp;-&gt;&nbsp;concat&nbsp;\"gt\"&nbsp;v\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VLesser&nbsp;v&nbsp;&nbsp;-&gt;&nbsp;concat&nbsp;\"lt\"&nbsp;v\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VEqual&nbsp;v&nbsp;&nbsp;&nbsp;-&gt;&nbsp;concat&nbsp;\"eq\"&nbsp;v\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VGreaterEqual&nbsp;v&nbsp;-&gt;&nbsp;concat&nbsp;\"ge\"&nbsp;v\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VLesserEqual&nbsp;v&nbsp;&nbsp;-&gt;&nbsp;concat&nbsp;\"le\"&nbsp;v\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VOr&nbsp;(c1,&nbsp;c2)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(varname_of_comparator&nbsp;c1)^\"_or_\"^(varname_of_comparator&nbsp;c2)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VAnd&nbsp;(c1,&nbsp;c2)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(varname_of_comparator&nbsp;c1)^\"_and_\"^(varname_of_comparator&nbsp;c2)\n\n\&nbsp;&nbsp;let&nbsp;version_0_3_or_after&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;comparator_apply&nbsp;t&nbsp;(VGreaterEqual&nbsp;(string_of_version&nbsp;\"0.3\"))\n\nend\n\nmodule&nbsp;OASISLicense&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISLicense.ml\"\n\n\&nbsp;&nbsp;(**&nbsp;License&nbsp;for&nbsp;_oasis&nbsp;fields\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@author&nbsp;Sylvain&nbsp;Le&nbsp;Gall\n\&nbsp;&nbsp;&nbsp;&nbsp;*)\n\n\n\n\&nbsp;&nbsp;type&nbsp;license&nbsp;=&nbsp;string&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;license_exception&nbsp;=&nbsp;string&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;license_version&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Version&nbsp;of&nbsp;OASISVersion.t\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VersionOrLater&nbsp;of&nbsp;OASISVersion.t\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;NoVersion\n\&nbsp;&nbsp;&nbsp;&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;license_dep_5_unit&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;license:&nbsp;&nbsp;&nbsp;license;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;excption:&nbsp;&nbsp;license_exception&nbsp;option;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version:&nbsp;&nbsp;&nbsp;license_version;\n\&nbsp;&nbsp;&nbsp;&nbsp;}\n\&nbsp;&nbsp;&nbsp;&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;license_dep_5&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;DEP5Unit&nbsp;of&nbsp;license_dep_5_unit\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;DEP5Or&nbsp;of&nbsp;license_dep_5&nbsp;list\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;DEP5And&nbsp;of&nbsp;license_dep_5&nbsp;list\n\&nbsp;&nbsp;&nbsp;&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;DEP5License&nbsp;of&nbsp;license_dep_5\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;OtherLicense&nbsp;of&nbsp;string&nbsp;(*&nbsp;URL&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;\n\nend\n\nmodule&nbsp;OASISExpr&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISExpr.ml\"\n\n\n\n\&nbsp;&nbsp;open&nbsp;OASISGettext\n\n\&nbsp;&nbsp;type&nbsp;test&nbsp;=&nbsp;string&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;flag&nbsp;=&nbsp;string&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;EBool&nbsp;of&nbsp;bool\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;ENot&nbsp;of&nbsp;t\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;EAnd&nbsp;of&nbsp;t&nbsp;*&nbsp;t\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;EOr&nbsp;of&nbsp;t&nbsp;*&nbsp;t\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;EFlag&nbsp;of&nbsp;flag\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;ETest&nbsp;of&nbsp;test&nbsp;*&nbsp;string\n\&nbsp;&nbsp;&nbsp;&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;'a&nbsp;choices&nbsp;=&nbsp;(t&nbsp;*&nbsp;'a)&nbsp;list&nbsp;\n\n\&nbsp;&nbsp;let&nbsp;eval&nbsp;var_get&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rec&nbsp;eval'&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;EBool&nbsp;b&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;ENot&nbsp;e&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not&nbsp;(eval'&nbsp;e)\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;EAnd&nbsp;(e1,&nbsp;e2)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(eval'&nbsp;e1)&nbsp;&amp;&amp;&nbsp;(eval'&nbsp;e2)\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;EOr&nbsp;(e1,&nbsp;e2)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(eval'&nbsp;e1)&nbsp;||&nbsp;(eval'&nbsp;e2)\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;EFlag&nbsp;nm&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;v&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var_get&nbsp;nm\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert(v&nbsp;=&nbsp;\"true\"&nbsp;||&nbsp;v&nbsp;=&nbsp;\"false\");\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(v&nbsp;=&nbsp;\"true\")\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;ETest&nbsp;(nm,&nbsp;vl)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;v&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var_get&nbsp;nm\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(v&nbsp;=&nbsp;vl)\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval'&nbsp;t\n\n\&nbsp;&nbsp;let&nbsp;choose&nbsp;?printer&nbsp;?name&nbsp;var_get&nbsp;lst&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rec&nbsp;choose_aux&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;(cond,&nbsp;vl)&nbsp;::&nbsp;tl&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;eval&nbsp;var_get&nbsp;cond&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vl\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;choose_aux&nbsp;tl\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;[]&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;str_lst&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;lst&nbsp;=&nbsp;[]&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s_&nbsp;\"&lt;empty&gt;\"\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.concat\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(s_&nbsp;\",&nbsp;\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(List.map\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;(cond,&nbsp;vl)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;printer&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;p&nbsp;-&gt;&nbsp;p&nbsp;vl\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;-&gt;&nbsp;s_&nbsp;\"&lt;no&nbsp;printer&gt;\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lst)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;name&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;nm&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;failwith\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Printf.sprintf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f_&nbsp;\"No&nbsp;result&nbsp;for&nbsp;the&nbsp;choice&nbsp;list&nbsp;'%s':&nbsp;%s\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nm&nbsp;str_lst)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;failwith\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Printf.sprintf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f_&nbsp;\"No&nbsp;result&nbsp;for&nbsp;a&nbsp;choice&nbsp;list:&nbsp;%s\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str_lst)\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;choose_aux&nbsp;(List.rev&nbsp;lst)\n\nend\n\nmodule&nbsp;OASISTypes&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISTypes.ml\"\n\n\n\n\n\&nbsp;&nbsp;type&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;string&nbsp;\n\&nbsp;&nbsp;type&nbsp;package_name&nbsp;&nbsp;=&nbsp;string&nbsp;\n\&nbsp;&nbsp;type&nbsp;url&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;string&nbsp;\n\&nbsp;&nbsp;type&nbsp;unix_dirname&nbsp;&nbsp;=&nbsp;string&nbsp;\n\&nbsp;&nbsp;type&nbsp;unix_filename&nbsp;=&nbsp;string&nbsp;\n\&nbsp;&nbsp;type&nbsp;host_dirname&nbsp;&nbsp;=&nbsp;string&nbsp;\n\&nbsp;&nbsp;type&nbsp;host_filename&nbsp;=&nbsp;string&nbsp;\n\&nbsp;&nbsp;type&nbsp;prog&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;string&nbsp;\n\&nbsp;&nbsp;type&nbsp;arg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;string&nbsp;\n\&nbsp;&nbsp;type&nbsp;args&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;string&nbsp;list&nbsp;\n\&nbsp;&nbsp;type&nbsp;command_line&nbsp;&nbsp;=&nbsp;(prog&nbsp;*&nbsp;arg&nbsp;list)&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;findlib_name&nbsp;=&nbsp;string&nbsp;\n\&nbsp;&nbsp;type&nbsp;findlib_full&nbsp;=&nbsp;string&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;compiled_object&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Byte\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Native\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Best\n\&nbsp;&nbsp;&nbsp;&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;dependency&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;FindlibPackage&nbsp;of&nbsp;findlib_full&nbsp;*&nbsp;OASISVersion.comparator&nbsp;option\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;InternalLibrary&nbsp;of&nbsp;name\n\&nbsp;&nbsp;&nbsp;&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;tool&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;ExternalTool&nbsp;of&nbsp;name\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;InternalExecutable&nbsp;of&nbsp;name\n\&nbsp;&nbsp;&nbsp;&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;vcs&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Darcs\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Git\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Svn\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Cvs\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Hg\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Bzr\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Arch\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Monotone\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;OtherVCS&nbsp;of&nbsp;url\n\&nbsp;&nbsp;&nbsp;&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;plugin_kind&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;&nbsp;`Configure\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Build\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Doc\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Test\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Install\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Extra\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]\n\n\&nbsp;&nbsp;type&nbsp;plugin_data_purpose&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;&nbsp;`Configure\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Build\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Install\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Clean\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Distclean\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Install\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Uninstall\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Test\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Doc\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Extra\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Other&nbsp;of&nbsp;string\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]\n\n\&nbsp;&nbsp;type&nbsp;'a&nbsp;plugin&nbsp;=&nbsp;'a&nbsp;*&nbsp;name&nbsp;*&nbsp;OASISVersion.t&nbsp;option&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;all_plugin&nbsp;=&nbsp;plugin_kind&nbsp;plugin\n\n\&nbsp;&nbsp;type&nbsp;plugin_data&nbsp;=&nbsp;(all_plugin&nbsp;*&nbsp;plugin_data_purpose&nbsp;*&nbsp;(unit&nbsp;-&gt;&nbsp;unit))&nbsp;list\n\n#&nbsp;102&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISTypes.ml\"\n\n\&nbsp;&nbsp;type&nbsp;'a&nbsp;conditional&nbsp;=&nbsp;'a&nbsp;OASISExpr.choices&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;custom&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pre_command:&nbsp;&nbsp;(command_line&nbsp;option)&nbsp;conditional;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;post_command:&nbsp;(command_line&nbsp;option)&nbsp;conditional;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;common_section&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_name:&nbsp;name;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_data:&nbsp;PropList.Data.t;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_plugin_data:&nbsp;plugin_data;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;build_section&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bs_build:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool&nbsp;conditional;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bs_install:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool&nbsp;conditional;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bs_path:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unix_dirname;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bs_compiled_object:&nbsp;compiled_object;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bs_build_depends:&nbsp;&nbsp;&nbsp;dependency&nbsp;list;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bs_build_tools:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tool&nbsp;list;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bs_c_sources:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unix_filename&nbsp;list;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bs_data_files:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(unix_filename&nbsp;*&nbsp;unix_filename&nbsp;option)&nbsp;list;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bs_ccopt:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args&nbsp;conditional;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bs_cclib:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args&nbsp;conditional;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bs_dlllib:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args&nbsp;conditional;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bs_dllpath:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args&nbsp;conditional;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bs_byteopt:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args&nbsp;conditional;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bs_nativeopt:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args&nbsp;conditional;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;library&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lib_modules:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;list;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lib_pack:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lib_internal_modules:&nbsp;&nbsp;&nbsp;string&nbsp;list;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lib_findlib_parent:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;findlib_name&nbsp;option;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lib_findlib_name:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;findlib_name&nbsp;option;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lib_findlib_containers:&nbsp;findlib_name&nbsp;list;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\n\n\n\&nbsp;&nbsp;type&nbsp;object_&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obj_modules:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;list;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obj_findlib_fullname:&nbsp;&nbsp;&nbsp;findlib_name&nbsp;list&nbsp;option;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;executable&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exec_custom:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exec_main_is:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unix_filename;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;flag&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag_description:&nbsp;&nbsp;string&nbsp;option;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag_default:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool&nbsp;conditional;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;source_repository&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src_repo_type:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vcs;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src_repo_location:&nbsp;&nbsp;&nbsp;&nbsp;url;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src_repo_browser:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;option;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src_repo_module:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;option;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src_repo_branch:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;option;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src_repo_tag:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;option;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src_repo_subdir:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unix_filename&nbsp;option;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;test&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test_type:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[`Test]&nbsp;plugin;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test_command:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;command_line&nbsp;conditional;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test_custom:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;custom;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test_working_directory:&nbsp;&nbsp;unix_filename&nbsp;option;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test_run:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool&nbsp;conditional;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test_tools:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tool&nbsp;list;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;doc_format&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;HTML&nbsp;of&nbsp;unix_filename\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;DocText\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;PDF\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;PostScript\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Info&nbsp;of&nbsp;unix_filename\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;DVI\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;OtherDoc\n\&nbsp;&nbsp;&nbsp;&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;doc&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc_type:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[`Doc]&nbsp;plugin;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc_custom:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;custom;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc_build:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool&nbsp;conditional;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc_install:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool&nbsp;conditional;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc_install_dir:&nbsp;unix_filename;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc_title:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc_authors:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;list;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc_abstract:&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;option;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc_format:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc_format;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc_data_files:&nbsp;&nbsp;(unix_filename&nbsp;*&nbsp;unix_filename&nbsp;option)&nbsp;list;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc_build_tools:&nbsp;tool&nbsp;list;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;section&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Library&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;common_section&nbsp;*&nbsp;build_section&nbsp;*&nbsp;library\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Object&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;common_section&nbsp;*&nbsp;build_section&nbsp;*&nbsp;object_\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Executable&nbsp;of&nbsp;common_section&nbsp;*&nbsp;build_section&nbsp;*&nbsp;executable\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Flag&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;common_section&nbsp;*&nbsp;flag\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;SrcRepo&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;common_section&nbsp;*&nbsp;source_repository\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Test&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;common_section&nbsp;*&nbsp;test\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Doc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;common_section&nbsp;*&nbsp;doc\n\&nbsp;&nbsp;&nbsp;&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;section_kind&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;`Library&nbsp;|&nbsp;`Object&nbsp;|&nbsp;`Executable&nbsp;|&nbsp;`Flag&nbsp;|&nbsp;`SrcRepo&nbsp;|&nbsp;`Test&nbsp;|&nbsp;`Doc&nbsp;]\n\n\&nbsp;&nbsp;type&nbsp;package&nbsp;=&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oasis_version:&nbsp;&nbsp;&nbsp;&nbsp;OASISVersion.t;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ocaml_version:&nbsp;&nbsp;&nbsp;&nbsp;OASISVersion.comparator&nbsp;option;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;findlib_version:&nbsp;&nbsp;OASISVersion.comparator&nbsp;option;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;package_name;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISVersion.t;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;license:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISLicense.t;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;license_file:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unix_filename&nbsp;option;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copyrights:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;list;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maintainers:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;list;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;authors:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;list;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;homepage:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;option;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;synopsis:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;description:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;option;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;categories:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;list;\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conf_type:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[`Configure]&nbsp;plugin;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conf_custom:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;custom;\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;build_type:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[`Build]&nbsp;plugin;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;build_custom:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;custom;\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;install_type:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[`Install]&nbsp;plugin;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;install_custom:&nbsp;&nbsp;&nbsp;custom;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uninstall_custom:&nbsp;custom;\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clean_custom:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;custom;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distclean_custom:&nbsp;custom;\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;files_ab:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unix_filename&nbsp;list;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sections:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;section&nbsp;list;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plugins:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[`Extra]&nbsp;plugin&nbsp;list;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;schema_data:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PropList.Data.t;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plugin_data:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plugin_data;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\n\nend\n\nmodule&nbsp;OASISUnixPath&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISUnixPath.ml\"\n\n\&nbsp;&nbsp;type&nbsp;unix_filename&nbsp;=&nbsp;string\n\&nbsp;&nbsp;type&nbsp;unix_dirname&nbsp;=&nbsp;string\n\n\&nbsp;&nbsp;type&nbsp;host_filename&nbsp;=&nbsp;string\n\&nbsp;&nbsp;type&nbsp;host_dirname&nbsp;=&nbsp;string\n\n\&nbsp;&nbsp;let&nbsp;current_dir_name&nbsp;=&nbsp;\".\"\n\n\&nbsp;&nbsp;let&nbsp;parent_dir_name&nbsp;=&nbsp;\"..\"\n\n\&nbsp;&nbsp;let&nbsp;is_current_dir&nbsp;fn&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;fn&nbsp;=&nbsp;current_dir_name&nbsp;||&nbsp;fn&nbsp;=&nbsp;\"\"\n\n\&nbsp;&nbsp;let&nbsp;concat&nbsp;f1&nbsp;f2&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;is_current_dir&nbsp;f1&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f2\n\&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;f1'&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;OASISString.strip_ends_with&nbsp;~what:\"/\"&nbsp;f1&nbsp;with&nbsp;Not_found&nbsp;-&gt;&nbsp;f1\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f1'^\"/\"^f2\n\n\&nbsp;&nbsp;let&nbsp;make&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;function\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;hd&nbsp;::&nbsp;tl&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.fold_left\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;f&nbsp;p&nbsp;-&gt;&nbsp;concat&nbsp;f&nbsp;p)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hd\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tl\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;[]&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invalid_arg&nbsp;\"OASISUnixPath.make\"\n\n\&nbsp;&nbsp;let&nbsp;dirname&nbsp;f&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.sub&nbsp;f&nbsp;0&nbsp;(String.rindex&nbsp;f&nbsp;'/')\n\&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Not_found&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current_dir_name\n\n\&nbsp;&nbsp;let&nbsp;basename&nbsp;f&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;pos_start&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(String.rindex&nbsp;f&nbsp;'/')&nbsp;+&nbsp;1\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.sub&nbsp;f&nbsp;pos_start&nbsp;((String.length&nbsp;f)&nbsp;-&nbsp;pos_start)\n\&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Not_found&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f\n\n\&nbsp;&nbsp;let&nbsp;chop_extension&nbsp;f&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;last_dot&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.rindex&nbsp;f&nbsp;'.'\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;sub&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.sub&nbsp;f&nbsp;0&nbsp;last_dot\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;last_slash&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.rindex&nbsp;f&nbsp;'/'\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;last_slash&nbsp;&lt;&nbsp;last_dot&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Not_found&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub\n\n\&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Not_found&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f\n\n\&nbsp;&nbsp;let&nbsp;capitalize_file&nbsp;f&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;dir&nbsp;=&nbsp;dirname&nbsp;f&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;base&nbsp;=&nbsp;basename&nbsp;f&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;concat&nbsp;dir&nbsp;(String.capitalize&nbsp;base)\n\n\&nbsp;&nbsp;let&nbsp;uncapitalize_file&nbsp;f&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;dir&nbsp;=&nbsp;dirname&nbsp;f&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;base&nbsp;=&nbsp;basename&nbsp;f&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;concat&nbsp;dir&nbsp;(String.uncapitalize&nbsp;base)\n\nend\n\nmodule&nbsp;OASISHostPath&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISHostPath.ml\"\n\n\n\&nbsp;&nbsp;open&nbsp;Filename\n\n\&nbsp;&nbsp;module&nbsp;Unix&nbsp;=&nbsp;OASISUnixPath\n\n\&nbsp;&nbsp;let&nbsp;make&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;function\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;[]&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invalid_arg&nbsp;\"OASISHostPath.make\"\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;hd&nbsp;::&nbsp;tl&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.fold_left&nbsp;Filename.concat&nbsp;hd&nbsp;tl\n\n\&nbsp;&nbsp;let&nbsp;of_unix&nbsp;ufn&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Sys.os_type&nbsp;=&nbsp;\"Unix\"&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ufn\n\&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;make\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(List.map\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;p&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;p&nbsp;=&nbsp;Unix.current_dir_name&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current_dir_name\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;p&nbsp;=&nbsp;Unix.parent_dir_name&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent_dir_name\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(OASISString.nsplit&nbsp;ufn&nbsp;'/'))\n\n\nend\n\nmodule&nbsp;OASISSection&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISSection.ml\"\n\n\&nbsp;&nbsp;open&nbsp;OASISTypes\n\n\&nbsp;&nbsp;let&nbsp;section_kind_common&nbsp;=&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;function\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Library&nbsp;(cs,&nbsp;_,&nbsp;_)&nbsp;-&gt;&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`Library,&nbsp;cs\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Object&nbsp;(cs,&nbsp;_,&nbsp;_)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`Object,&nbsp;cs\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Executable&nbsp;(cs,&nbsp;_,&nbsp;_)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`Executable,&nbsp;cs\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Flag&nbsp;(cs,&nbsp;_)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`Flag,&nbsp;cs\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;SrcRepo&nbsp;(cs,&nbsp;_)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`SrcRepo,&nbsp;cs\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Test&nbsp;(cs,&nbsp;_)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`Test,&nbsp;cs\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Doc&nbsp;(cs,&nbsp;_)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`Doc,&nbsp;cs\n\n\&nbsp;&nbsp;let&nbsp;section_common&nbsp;sct&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;snd&nbsp;(section_kind_common&nbsp;sct)\n\n\&nbsp;&nbsp;let&nbsp;section_common_set&nbsp;cs&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;function\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Library&nbsp;(_,&nbsp;bs,&nbsp;lib)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;Library&nbsp;(cs,&nbsp;bs,&nbsp;lib)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Object&nbsp;(_,&nbsp;bs,&nbsp;obj)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;Object&nbsp;(cs,&nbsp;bs,&nbsp;obj)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Executable&nbsp;(_,&nbsp;bs,&nbsp;exec)&nbsp;-&gt;&nbsp;Executable&nbsp;(cs,&nbsp;bs,&nbsp;exec)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Flag&nbsp;(_,&nbsp;flg)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;Flag&nbsp;(cs,&nbsp;flg)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;SrcRepo&nbsp;(_,&nbsp;src_repo)&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;SrcRepo&nbsp;(cs,&nbsp;src_repo)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Test&nbsp;(_,&nbsp;tst)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;Test&nbsp;(cs,&nbsp;tst)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Doc&nbsp;(_,&nbsp;doc)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;Doc&nbsp;(cs,&nbsp;doc)\n\n\&nbsp;&nbsp;(**&nbsp;Key&nbsp;used&nbsp;to&nbsp;identify&nbsp;section\n\&nbsp;&nbsp;&nbsp;&nbsp;*)\n\&nbsp;&nbsp;let&nbsp;section_id&nbsp;sct&nbsp;=&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;k,&nbsp;cs&nbsp;=&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;section_kind_common&nbsp;sct\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k,&nbsp;cs.cs_name\n\n\&nbsp;&nbsp;let&nbsp;string_of_section&nbsp;sct&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;k,&nbsp;nm&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;section_id&nbsp;sct\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(match&nbsp;k&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Library&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;\"library\"&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Object&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;\"object\"\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Executable&nbsp;-&gt;&nbsp;\"executable\"\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Flag&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;\"flag\"\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`SrcRepo&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;\"src&nbsp;repository\"\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Test&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;\"test\"\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Doc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;\"doc\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^\"&nbsp;\"^nm\n\n\&nbsp;&nbsp;let&nbsp;section_find&nbsp;id&nbsp;scts&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;List.find\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;sct&nbsp;-&gt;&nbsp;id&nbsp;=&nbsp;section_id&nbsp;sct)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scts\n\n\&nbsp;&nbsp;module&nbsp;CSection&nbsp;=\n\&nbsp;&nbsp;struct\n\&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;t&nbsp;=&nbsp;section\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;id&nbsp;=&nbsp;section_id\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;compare&nbsp;t1&nbsp;t2&nbsp;=&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compare&nbsp;(id&nbsp;t1)&nbsp;(id&nbsp;t2)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;equal&nbsp;t1&nbsp;t2&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(id&nbsp;t1)&nbsp;=&nbsp;(id&nbsp;t2)\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;hash&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hashtbl.hash&nbsp;(id&nbsp;t)\n\&nbsp;&nbsp;end\n\n\&nbsp;&nbsp;module&nbsp;MapSection&nbsp;=&nbsp;Map.Make(CSection)\n\&nbsp;&nbsp;module&nbsp;SetSection&nbsp;=&nbsp;Set.Make(CSection)\n\nend\n\nmodule&nbsp;OASISBuildSection&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISBuildSection.ml\"\n\nend\n\nmodule&nbsp;OASISExecutable&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISExecutable.ml\"\n\n\&nbsp;&nbsp;open&nbsp;OASISTypes\n\n\&nbsp;&nbsp;let&nbsp;unix_exec_is&nbsp;(cs,&nbsp;bs,&nbsp;exec)&nbsp;is_native&nbsp;ext_dll&nbsp;suffix_program&nbsp;=&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;dir&nbsp;=&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISUnixPath.concat\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bs.bs_path\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(OASISUnixPath.dirname&nbsp;exec.exec_main_is)\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;is_native_exec&nbsp;=&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;bs.bs_compiled_object&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Native&nbsp;-&gt;&nbsp;true\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Best&nbsp;-&gt;&nbsp;is_native&nbsp;()\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Byte&nbsp;-&gt;&nbsp;false\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISUnixPath.concat\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dir\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cs.cs_name^(suffix_program&nbsp;())),\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;is_native_exec&nbsp;&amp;&amp;&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not&nbsp;exec.exec_custom&nbsp;&amp;&amp;&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bs.bs_c_sources&nbsp;&lt;&gt;&nbsp;[]&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;(dir^\"/dll\"^cs.cs_name^\"_stubs\"^(ext_dll&nbsp;()))\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None\n\nend\n\nmodule&nbsp;OASISLibrary&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISLibrary.ml\"\n\n\&nbsp;&nbsp;open&nbsp;OASISTypes\n\&nbsp;&nbsp;open&nbsp;OASISUtils\n\&nbsp;&nbsp;open&nbsp;OASISGettext\n\&nbsp;&nbsp;open&nbsp;OASISSection\n\n\&nbsp;&nbsp;(*&nbsp;Look&nbsp;for&nbsp;a&nbsp;module&nbsp;file,&nbsp;considering&nbsp;capitalization&nbsp;or&nbsp;not.&nbsp;*)\n\&nbsp;&nbsp;let&nbsp;find_module&nbsp;source_file_exists&nbsp;bs&nbsp;modul&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;possible_base_fn&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.map\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(OASISUnixPath.concat&nbsp;bs.bs_path)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[modul;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISUnixPath.uncapitalize_file&nbsp;modul;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISUnixPath.capitalize_file&nbsp;modul]\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;TODO:&nbsp;we&nbsp;should&nbsp;be&nbsp;able&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;determine&nbsp;the&nbsp;source&nbsp;for&nbsp;every\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;files.&nbsp;Hence&nbsp;we&nbsp;should&nbsp;introduce&nbsp;a&nbsp;Module(source:&nbsp;fn)&nbsp;for&nbsp;the&nbsp;fields\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Modules&nbsp;and&nbsp;InternalModules\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.fold_left\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;acc&nbsp;base_fn&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;acc&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`No_sources&nbsp;_&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;file_found&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.fold_left\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;acc&nbsp;ext&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;source_file_exists&nbsp;(base_fn^ext)&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(base_fn^ext)&nbsp;::&nbsp;acc\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acc)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[\".ml\";&nbsp;\".mli\";&nbsp;\".mll\";&nbsp;\".mly\"]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;file_found&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;[]&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acc\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;lst&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`Sources&nbsp;(base_fn,&nbsp;lst)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Sources&nbsp;_&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acc)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(`No_sources&nbsp;possible_base_fn)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;possible_base_fn\n\n\&nbsp;&nbsp;let&nbsp;source_unix_files&nbsp;~ctxt&nbsp;(cs,&nbsp;bs,&nbsp;lib)&nbsp;source_file_exists&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;List.fold_left\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;acc&nbsp;modul&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;find_module&nbsp;source_file_exists&nbsp;bs&nbsp;modul&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Sources&nbsp;(base_fn,&nbsp;lst)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(base_fn,&nbsp;lst)&nbsp;::&nbsp;acc\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`No_sources&nbsp;_&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISMessage.warning\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ctxt\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f_&nbsp;\"Cannot&nbsp;find&nbsp;source&nbsp;file&nbsp;matching&nbsp;\\\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;'%s'&nbsp;in&nbsp;library&nbsp;%s\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modul&nbsp;cs.cs_name;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acc)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(lib.lib_modules&nbsp;@&nbsp;lib.lib_internal_modules)\n\n\&nbsp;&nbsp;let&nbsp;generated_unix_files\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ctxt\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~is_native\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~has_native_dynlink\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ext_lib\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ext_dll\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~source_file_exists\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cs,&nbsp;bs,&nbsp;lib)&nbsp;=\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;find_modules&nbsp;lst&nbsp;ext&nbsp;=&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;find_module&nbsp;modul&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;find_module&nbsp;source_file_exists&nbsp;bs&nbsp;modul&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Sources&nbsp;(base_fn,&nbsp;_)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[base_fn]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`No_sources&nbsp;lst&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISMessage.warning\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ctxt\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f_&nbsp;\"Cannot&nbsp;find&nbsp;source&nbsp;file&nbsp;matching&nbsp;\\\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;'%s'&nbsp;in&nbsp;library&nbsp;%s\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modul&nbsp;cs.cs_name;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lst\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.map&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;nm&nbsp;-&gt;&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.map&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;base_fn&nbsp;-&gt;&nbsp;base_fn&nbsp;^\".\"^ext)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(find_module&nbsp;nm))\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lst\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;The&nbsp;headers&nbsp;that&nbsp;should&nbsp;be&nbsp;compiled&nbsp;along&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;headers&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;lib.lib_pack&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;find_modules\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lib.lib_modules\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\"cmi\"\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;The&nbsp;.cmx&nbsp;that&nbsp;be&nbsp;compiled&nbsp;along&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;cmxs&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;should_be_built&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(not&nbsp;lib.lib_pack)&nbsp;&amp;&amp;&nbsp;(*&nbsp;Do&nbsp;not&nbsp;install&nbsp;.cmx&nbsp;packed&nbsp;submodules&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;bs.bs_compiled_object&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Native&nbsp;-&gt;&nbsp;true\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Best&nbsp;-&gt;&nbsp;is_native\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Byte&nbsp;-&gt;&nbsp;false\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;should_be_built&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;find_modules\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(lib.lib_modules&nbsp;@&nbsp;lib.lib_internal_modules)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\"cmx\"\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;acc_nopath&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Compute&nbsp;what&nbsp;libraries&nbsp;should&nbsp;be&nbsp;built&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;acc_nopath&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Add&nbsp;the&nbsp;packed&nbsp;header&nbsp;file&nbsp;if&nbsp;required&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;add_pack_header&nbsp;acc&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;lib.lib_pack&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[cs.cs_name^\".cmi\"]&nbsp;::&nbsp;acc\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acc\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;byte&nbsp;acc&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_pack_header&nbsp;([cs.cs_name^\".cma\"]&nbsp;::&nbsp;acc)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;native&nbsp;acc&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;acc&nbsp;=&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_pack_header\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(if&nbsp;has_native_dynlink&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[cs.cs_name^\".cmxs\"]&nbsp;::&nbsp;acc\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;acc)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[cs.cs_name^\".cmxa\"]&nbsp;::&nbsp;[cs.cs_name^ext_lib]&nbsp;::&nbsp;acc\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;bs.bs_compiled_object&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Native&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte&nbsp;(native&nbsp;acc_nopath)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Best&nbsp;when&nbsp;is_native&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte&nbsp;(native&nbsp;acc_nopath)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Byte&nbsp;|&nbsp;Best&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte&nbsp;acc_nopath\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Add&nbsp;C&nbsp;library&nbsp;to&nbsp;be&nbsp;built&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;acc_nopath&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;bs.bs_c_sources&nbsp;&lt;&gt;&nbsp;[]&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[\"lib\"^cs.cs_name^\"_stubs\"^ext_lib]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[\"dll\"^cs.cs_name^\"_stubs\"^ext_dll]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acc_nopath\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acc_nopath\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;All&nbsp;the&nbsp;files&nbsp;generated&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.rev_append\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(List.rev_map\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(List.rev_map\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(OASISUnixPath.concat&nbsp;bs.bs_path))\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acc_nopath)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(headers&nbsp;@&nbsp;cmxs)\n\nend\n\nmodule&nbsp;OASISObject&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISObject.ml\"\n\n\&nbsp;&nbsp;open&nbsp;OASISTypes\n\&nbsp;&nbsp;open&nbsp;OASISGettext\n\n\&nbsp;&nbsp;let&nbsp;source_unix_files&nbsp;~ctxt&nbsp;(cs,&nbsp;bs,&nbsp;obj)&nbsp;source_file_exists&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;List.fold_left\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;acc&nbsp;modul&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;OASISLibrary.find_module&nbsp;source_file_exists&nbsp;bs&nbsp;modul&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Sources&nbsp;(base_fn,&nbsp;lst)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(base_fn,&nbsp;lst)&nbsp;::&nbsp;acc\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`No_sources&nbsp;_&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISMessage.warning\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ctxt\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f_&nbsp;\"Cannot&nbsp;find&nbsp;source&nbsp;file&nbsp;matching&nbsp;\\\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;'%s'&nbsp;in&nbsp;object&nbsp;%s\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modul&nbsp;cs.cs_name;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acc)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obj.obj_modules\n\n\n\&nbsp;&nbsp;let&nbsp;generated_unix_files\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ctxt\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~is_native\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~source_file_exists\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cs,&nbsp;bs,&nbsp;obj)&nbsp;=\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;find_module&nbsp;ext&nbsp;modul&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;OASISLibrary.find_module&nbsp;source_file_exists&nbsp;bs&nbsp;modul&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Sources&nbsp;(base_fn,&nbsp;_)&nbsp;-&gt;&nbsp;[base_fn&nbsp;^&nbsp;ext]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`No_sources&nbsp;lst&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISMessage.warning\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ctxt\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f_&nbsp;\"Cannot&nbsp;find&nbsp;source&nbsp;file&nbsp;matching&nbsp;\\\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;'%s'&nbsp;in&nbsp;object&nbsp;%s\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modul&nbsp;cs.cs_name&nbsp;;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lst\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;header,&nbsp;byte,&nbsp;native,&nbsp;c_object,&nbsp;f&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;obj.obj_modules&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;[&nbsp;m&nbsp;]&nbsp;-&gt;&nbsp;(find_module&nbsp;\".cmi\"&nbsp;m,\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;find_module&nbsp;\".cmo\"&nbsp;m,\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;find_module&nbsp;\".cmx\"&nbsp;m,\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;find_module&nbsp;\".o\"&nbsp;m,\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;x&nbsp;-&gt;&nbsp;x)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;-&gt;&nbsp;([cs.cs_name&nbsp;^&nbsp;\".cmi\"],\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[cs.cs_name&nbsp;^&nbsp;\".cmo\"],\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[cs.cs_name&nbsp;^&nbsp;\".cmx\"],\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[cs.cs_name&nbsp;^&nbsp;\".o\"],\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISUnixPath.concat&nbsp;bs.bs_path)\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.map&nbsp;(List.map&nbsp;f)&nbsp;(\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;bs.bs_compiled_object&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Native&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;native&nbsp;::&nbsp;c_object&nbsp;::&nbsp;byte&nbsp;::&nbsp;header&nbsp;::&nbsp;[]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Best&nbsp;when&nbsp;is_native&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;native&nbsp;::&nbsp;c_object&nbsp;::&nbsp;byte&nbsp;::&nbsp;header&nbsp;::&nbsp;[]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Byte&nbsp;|&nbsp;Best&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte&nbsp;::&nbsp;header&nbsp;::&nbsp;[])\n\nend\n\nmodule&nbsp;OASISFindlib&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISFindlib.ml\"\n\n\n\&nbsp;&nbsp;open&nbsp;OASISTypes\n\&nbsp;&nbsp;open&nbsp;OASISUtils\n\&nbsp;&nbsp;open&nbsp;OASISGettext\n\&nbsp;&nbsp;open&nbsp;OASISSection\n\n\&nbsp;&nbsp;type&nbsp;library_name&nbsp;=&nbsp;name\n\&nbsp;&nbsp;type&nbsp;findlib_part_name&nbsp;=&nbsp;name\n\&nbsp;&nbsp;type&nbsp;'a&nbsp;map_of_findlib_part_name&nbsp;=&nbsp;'a&nbsp;OASISUtils.MapString.t\n\n\&nbsp;&nbsp;exception&nbsp;InternalLibraryNotFound&nbsp;of&nbsp;library_name\n\&nbsp;&nbsp;exception&nbsp;FindlibPackageNotFound&nbsp;of&nbsp;findlib_name\n\n\&nbsp;&nbsp;type&nbsp;group_t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Container&nbsp;of&nbsp;findlib_name&nbsp;*&nbsp;group_t&nbsp;list\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Package&nbsp;of&nbsp;(findlib_name&nbsp;*\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;common_section&nbsp;*\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;build_section&nbsp;*\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[`Library&nbsp;of&nbsp;library&nbsp;|&nbsp;`Object&nbsp;of&nbsp;object_]&nbsp;*\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;group_t&nbsp;list)\n\n\&nbsp;&nbsp;type&nbsp;data&nbsp;=&nbsp;common_section&nbsp;*\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;build_section&nbsp;*\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[`Library&nbsp;of&nbsp;library&nbsp;|&nbsp;`Object&nbsp;of&nbsp;object_]\n\&nbsp;&nbsp;type&nbsp;tree&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Node&nbsp;of&nbsp;(data&nbsp;option)&nbsp;*&nbsp;(tree&nbsp;MapString.t)\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Leaf&nbsp;of&nbsp;data\n\n\&nbsp;&nbsp;let&nbsp;findlib_mapping&nbsp;pkg&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Map&nbsp;from&nbsp;library&nbsp;name&nbsp;to&nbsp;either&nbsp;full&nbsp;findlib&nbsp;name&nbsp;or&nbsp;parts&nbsp;+&nbsp;parent.&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;fndlb_parts_of_lib_name&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;fndlb_parts&nbsp;cs&nbsp;lib&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;name&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;lib.lib_findlib_name&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;nm&nbsp;-&gt;&nbsp;nm\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;-&gt;&nbsp;cs.cs_name\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;name&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.concat&nbsp;\".\"&nbsp;(lib.lib_findlib_containers&nbsp;@&nbsp;[name])\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.fold_left\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;mp&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Library&nbsp;(cs,&nbsp;_,&nbsp;lib)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;lib_name&nbsp;=&nbsp;cs.cs_name&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;fndlb_parts&nbsp;=&nbsp;fndlb_parts&nbsp;cs&nbsp;lib&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;MapString.mem&nbsp;lib_name&nbsp;mp&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;failwithf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f_&nbsp;\"The&nbsp;library&nbsp;name&nbsp;'%s'&nbsp;is&nbsp;used&nbsp;more&nbsp;than&nbsp;once.\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lib_name;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;lib.lib_findlib_parent&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;lib_name_parent&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MapString.add\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lib_name\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(`Unsolved&nbsp;(lib_name_parent,&nbsp;fndlb_parts))\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mp\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MapString.add\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lib_name\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(`Solved&nbsp;fndlb_parts)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mp\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Object&nbsp;(cs,&nbsp;_,&nbsp;obj)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;obj_name&nbsp;=&nbsp;cs.cs_name&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;MapString.mem&nbsp;obj_name&nbsp;mp&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;failwithf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f_&nbsp;\"The&nbsp;object&nbsp;name&nbsp;'%s'&nbsp;is&nbsp;used&nbsp;more&nbsp;than&nbsp;once.\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obj_name;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;findlib_full_name&nbsp;=&nbsp;match&nbsp;obj.obj_findlib_fullname&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;ns&nbsp;-&gt;&nbsp;String.concat&nbsp;\".\"&nbsp;ns\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;-&gt;&nbsp;obj_name\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MapString.add\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obj_name\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(`Solved&nbsp;findlib_full_name)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mp\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Executable&nbsp;_&nbsp;|&nbsp;Test&nbsp;_&nbsp;|&nbsp;Flag&nbsp;_&nbsp;|&nbsp;SrcRepo&nbsp;_&nbsp;|&nbsp;Doc&nbsp;_&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mp)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MapString.empty\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pkg.sections\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Solve&nbsp;the&nbsp;above&nbsp;graph&nbsp;to&nbsp;be&nbsp;only&nbsp;library&nbsp;name&nbsp;to&nbsp;full&nbsp;findlib&nbsp;name.&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;fndlb_name_of_lib_name&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rec&nbsp;solve&nbsp;visited&nbsp;mp&nbsp;lib_name&nbsp;lib_name_child&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;SetString.mem&nbsp;lib_name&nbsp;visited&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;failwithf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f_&nbsp;\"Library&nbsp;'%s'&nbsp;is&nbsp;involved&nbsp;in&nbsp;a&nbsp;cycle&nbsp;\\\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;regard&nbsp;to&nbsp;findlib&nbsp;naming.\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lib_name;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;visited&nbsp;=&nbsp;SetString.add&nbsp;lib_name&nbsp;visited&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;MapString.find&nbsp;lib_name&nbsp;mp&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Solved&nbsp;fndlb_nm&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fndlb_nm,&nbsp;mp\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Unsolved&nbsp;(lib_nm_parent,&nbsp;post_fndlb_nm)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;pre_fndlb_nm,&nbsp;mp&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;solve&nbsp;visited&nbsp;mp&nbsp;lib_nm_parent&nbsp;lib_name\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;fndlb_nm&nbsp;=&nbsp;pre_fndlb_nm^\".\"^post_fndlb_nm&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fndlb_nm,&nbsp;MapString.add&nbsp;lib_name&nbsp;(`Solved&nbsp;fndlb_nm)&nbsp;mp\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Not_found&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;failwithf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f_&nbsp;\"Library&nbsp;'%s',&nbsp;which&nbsp;is&nbsp;defined&nbsp;as&nbsp;the&nbsp;findlib&nbsp;parent&nbsp;of&nbsp;\\\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;library&nbsp;'%s',&nbsp;doesn't&nbsp;exist.\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lib_name&nbsp;lib_name_child\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;mp&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MapString.fold\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;lib_name&nbsp;status&nbsp;mp&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;status&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Solved&nbsp;_&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Solved&nbsp;initialy,&nbsp;no&nbsp;need&nbsp;to&nbsp;go&nbsp;further&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mp\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Unsolved&nbsp;_&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;_,&nbsp;mp&nbsp;=&nbsp;solve&nbsp;SetString.empty&nbsp;mp&nbsp;lib_name&nbsp;\"&lt;none&gt;\"&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mp)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fndlb_parts_of_lib_name\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fndlb_parts_of_lib_name\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MapString.map\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(function\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Solved&nbsp;fndlb_nm&nbsp;-&gt;&nbsp;fndlb_nm\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Unsolved&nbsp;_&nbsp;-&gt;&nbsp;assert&nbsp;false)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mp\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Convert&nbsp;an&nbsp;internal&nbsp;library&nbsp;name&nbsp;to&nbsp;a&nbsp;findlib&nbsp;name.&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;findlib_name_of_library_name&nbsp;lib_nm&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MapString.find&nbsp;lib_nm&nbsp;fndlb_name_of_lib_name\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Not_found&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;(InternalLibraryNotFound&nbsp;lib_nm)\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Add&nbsp;a&nbsp;library&nbsp;to&nbsp;the&nbsp;tree.\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;add&nbsp;sct&nbsp;mp&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;fndlb_fullname&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;cs,&nbsp;_,&nbsp;_&nbsp;=&nbsp;sct&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;lib_name&nbsp;=&nbsp;cs.cs_name&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;findlib_name_of_library_name&nbsp;lib_name\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rec&nbsp;add_children&nbsp;nm_lst&nbsp;(children&nbsp;:&nbsp;tree&nbsp;MapString.t)&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;nm_lst&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;(hd&nbsp;::&nbsp;tl)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;node&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_node&nbsp;tl&nbsp;(MapString.find&nbsp;hd&nbsp;children)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Not_found&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;New&nbsp;node&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_node&nbsp;tl\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MapString.add&nbsp;hd&nbsp;node&nbsp;children\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;[]&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Should&nbsp;not&nbsp;have&nbsp;a&nbsp;nameless&nbsp;library.&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert&nbsp;false\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;add_node&nbsp;tl&nbsp;node&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;tl&nbsp;=&nbsp;[]&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;node&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Node&nbsp;(None,&nbsp;children)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Node&nbsp;(Some&nbsp;sct,&nbsp;children)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Leaf&nbsp;(cs',&nbsp;_,&nbsp;_)&nbsp;|&nbsp;Node&nbsp;(Some&nbsp;(cs',&nbsp;_,&nbsp;_),&nbsp;_)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;TODO:&nbsp;allow&nbsp;to&nbsp;merge&nbsp;Package,&nbsp;i.e.\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;archive(byte)&nbsp;=&nbsp;\"foo.cma&nbsp;foo_init.cmo\"\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;cs,&nbsp;_,&nbsp;_&nbsp;=&nbsp;sct&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;failwithf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f_&nbsp;\"Library&nbsp;'%s'&nbsp;and&nbsp;'%s'&nbsp;have&nbsp;the&nbsp;same&nbsp;findlib&nbsp;name&nbsp;'%s'\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs.cs_name&nbsp;cs'.cs_name&nbsp;fndlb_fullname\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;node&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Leaf&nbsp;data&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Node&nbsp;(Some&nbsp;data,&nbsp;add_children&nbsp;tl&nbsp;MapString.empty)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Node&nbsp;(data_opt,&nbsp;children)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Node&nbsp;(data_opt,&nbsp;add_children&nbsp;tl&nbsp;children)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;new_node&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;[]&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Leaf&nbsp;sct\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;hd&nbsp;::&nbsp;tl&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Node&nbsp;(None,&nbsp;MapString.add&nbsp;hd&nbsp;(new_node&nbsp;tl)&nbsp;MapString.empty)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_children&nbsp;(OASISString.nsplit&nbsp;fndlb_fullname&nbsp;'.')&nbsp;mp\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rec&nbsp;group_of_tree&nbsp;mp&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MapString.fold\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;nm&nbsp;node&nbsp;acc&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;cur&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;node&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Node&nbsp;(Some&nbsp;(cs,&nbsp;bs,&nbsp;lib),&nbsp;children)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Package&nbsp;(nm,&nbsp;cs,&nbsp;bs,&nbsp;lib,&nbsp;group_of_tree&nbsp;children)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Node&nbsp;(None,&nbsp;children)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Container&nbsp;(nm,&nbsp;group_of_tree&nbsp;children)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Leaf&nbsp;(cs,&nbsp;bs,&nbsp;lib)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Package&nbsp;(nm,&nbsp;cs,&nbsp;bs,&nbsp;lib,&nbsp;[])\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cur&nbsp;::&nbsp;acc)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mp&nbsp;[]\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;group_mp&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.fold_left\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;mp&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Library&nbsp;(cs,&nbsp;bs,&nbsp;lib)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;(cs,&nbsp;bs,&nbsp;`Library&nbsp;lib)&nbsp;mp\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Object&nbsp;(cs,&nbsp;bs,&nbsp;obj)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;(cs,&nbsp;bs,&nbsp;`Object&nbsp;obj)&nbsp;mp\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mp)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MapString.empty\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pkg.sections\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;groups&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;group_of_tree&nbsp;group_mp\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;library_name_of_findlib_name&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lazy.lazy_from_fun\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;()&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Revert&nbsp;findlib_name_of_library_name.&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MapString.fold\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;k&nbsp;v&nbsp;mp&nbsp;-&gt;&nbsp;MapString.add&nbsp;v&nbsp;k&nbsp;mp)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fndlb_name_of_lib_name\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MapString.empty)\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;library_name_of_findlib_name&nbsp;fndlb_nm&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MapString.find&nbsp;fndlb_nm&nbsp;(Lazy.force&nbsp;library_name_of_findlib_name)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Not_found&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;(FindlibPackageNotFound&nbsp;fndlb_nm)\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;groups,\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;findlib_name_of_library_name,\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;library_name_of_findlib_name\n\n\&nbsp;&nbsp;let&nbsp;findlib_of_group&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;function\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Container&nbsp;(fndlb_nm,&nbsp;_)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Package&nbsp;(fndlb_nm,&nbsp;_,&nbsp;_,&nbsp;_,&nbsp;_)&nbsp;-&gt;&nbsp;fndlb_nm\n\n\&nbsp;&nbsp;let&nbsp;root_of_group&nbsp;grp&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rec&nbsp;root_lib_aux&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;We&nbsp;do&nbsp;a&nbsp;DFS&nbsp;in&nbsp;the&nbsp;group.&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Container&nbsp;(_,&nbsp;children)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.fold_left\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;res&nbsp;grp&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;res&nbsp;=&nbsp;None&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root_lib_aux&nbsp;grp\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;children\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Package&nbsp;(_,&nbsp;cs,&nbsp;bs,&nbsp;lib,&nbsp;_)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;(cs,&nbsp;bs,&nbsp;lib)\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;root_lib_aux&nbsp;grp&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;res&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;failwithf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f_&nbsp;\"Unable&nbsp;to&nbsp;determine&nbsp;root&nbsp;library&nbsp;of&nbsp;findlib&nbsp;library&nbsp;'%s'\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(findlib_of_group&nbsp;grp)\n\nend\n\nmodule&nbsp;OASISFlag&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISFlag.ml\"\n\nend\n\nmodule&nbsp;OASISPackage&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISPackage.ml\"\n\nend\n\nmodule&nbsp;OASISSourceRepository&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISSourceRepository.ml\"\n\nend\n\nmodule&nbsp;OASISTest&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISTest.ml\"\n\nend\n\nmodule&nbsp;OASISDocument&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISDocument.ml\"\n\nend\n\nmodule&nbsp;OASISExec&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISExec.ml\"\n\n\&nbsp;&nbsp;open&nbsp;OASISGettext\n\&nbsp;&nbsp;open&nbsp;OASISUtils\n\&nbsp;&nbsp;open&nbsp;OASISMessage\n\n\&nbsp;&nbsp;(*&nbsp;TODO:&nbsp;I&nbsp;don't&nbsp;like&nbsp;this&nbsp;quote,&nbsp;it&nbsp;is&nbsp;there&nbsp;because&nbsp;$(rm)&nbsp;foo&nbsp;expands&nbsp;to\n\&nbsp;&nbsp;&nbsp;*&nbsp;'rm&nbsp;-f'&nbsp;foo...\n\&nbsp;&nbsp;&nbsp;*)\n\&nbsp;&nbsp;let&nbsp;run&nbsp;~ctxt&nbsp;?f_exit_code&nbsp;?(quote=true)&nbsp;cmd&nbsp;args&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;cmd&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;quote&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Sys.os_type&nbsp;=&nbsp;\"Win32\"&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;String.contains&nbsp;cmd&nbsp;'&nbsp;'&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Double&nbsp;the&nbsp;1st&nbsp;double&nbsp;quote...&nbsp;win32...&nbsp;sigh&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\"\\\"\"^(Filename.quote&nbsp;cmd)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filename.quote&nbsp;cmd\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;cmdline&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.concat&nbsp;\"&nbsp;\"&nbsp;(cmd&nbsp;::&nbsp;args)\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;info&nbsp;~ctxt&nbsp;(f_&nbsp;\"Running&nbsp;command&nbsp;'%s'\")&nbsp;cmdline;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;f_exit_code,&nbsp;Sys.command&nbsp;cmdline&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None,&nbsp;0&nbsp;-&gt;&nbsp;()\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None,&nbsp;i&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;failwithf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f_&nbsp;\"Command&nbsp;'%s'&nbsp;terminated&nbsp;with&nbsp;error&nbsp;code&nbsp;%d\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmdline&nbsp;i\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;f,&nbsp;i&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;i\n\n\&nbsp;&nbsp;let&nbsp;run_read_output&nbsp;~ctxt&nbsp;?f_exit_code&nbsp;cmd&nbsp;args&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;fn&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filename.temp_file&nbsp;\"oasis-\"&nbsp;\".txt\"\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;()&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;run&nbsp;~ctxt&nbsp;?f_exit_code&nbsp;cmd&nbsp;(args&nbsp;@&nbsp;[\"&gt;\";&nbsp;Filename.quote&nbsp;fn])\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;chn&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open_in&nbsp;fn\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;routput&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ref&nbsp;[]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;true&nbsp;do\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;routput&nbsp;:=&nbsp;(input_line&nbsp;chn)&nbsp;::&nbsp;!routput\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;End_of_file&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;()\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close_in&nbsp;chn;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sys.remove&nbsp;fn;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.rev&nbsp;!routput\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;e&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(try&nbsp;Sys.remove&nbsp;fn&nbsp;with&nbsp;_&nbsp;-&gt;&nbsp;());\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;e\n\n\&nbsp;&nbsp;let&nbsp;run_read_one_line&nbsp;~ctxt&nbsp;?f_exit_code&nbsp;cmd&nbsp;args&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;run_read_output&nbsp;~ctxt&nbsp;?f_exit_code&nbsp;cmd&nbsp;args&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;[fst]&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fst\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;lst&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;failwithf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f_&nbsp;\"Command&nbsp;return&nbsp;unexpected&nbsp;output&nbsp;%S\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(String.concat&nbsp;\"\\n\"&nbsp;lst)\nend\n\nmodule&nbsp;OASISFileUtil&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISFileUtil.ml\"\n\n\&nbsp;&nbsp;open&nbsp;OASISGettext\n\n\&nbsp;&nbsp;let&nbsp;file_exists_case&nbsp;fn&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;dirname&nbsp;=&nbsp;Filename.dirname&nbsp;fn&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;basename&nbsp;=&nbsp;Filename.basename&nbsp;fn&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Sys.file_exists&nbsp;dirname&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;basename&nbsp;=&nbsp;Filename.current_dir_name&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;true\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.mem\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;basename\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Array.to_list&nbsp;(Sys.readdir&nbsp;dirname))\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false\n\n\&nbsp;&nbsp;let&nbsp;find_file&nbsp;?(case_sensitive=true)&nbsp;paths&nbsp;exts&nbsp;=\n\n\&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Cardinal&nbsp;product&nbsp;of&nbsp;two&nbsp;list&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;(&nbsp;*&nbsp;)&nbsp;lst1&nbsp;lst2&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.flatten\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(List.map\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;a&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.map\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;b&nbsp;-&gt;&nbsp;a,b)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lst2)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lst1)\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rec&nbsp;combined_paths&nbsp;lst&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;lst&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;p1&nbsp;::&nbsp;p2&nbsp;::&nbsp;tl&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;acc&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(List.map\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;(a,b)&nbsp;-&gt;&nbsp;Filename.concat&nbsp;a&nbsp;b)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(p1&nbsp;*&nbsp;p2))\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_paths&nbsp;(acc&nbsp;::&nbsp;tl)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;[e]&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;[]&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;alternatives&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.map\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;(p,e)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;String.length&nbsp;e&nbsp;&gt;&nbsp;0&nbsp;&amp;&amp;&nbsp;e.[0]&nbsp;&lt;&gt;&nbsp;'.'&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;^&nbsp;\".\"&nbsp;^&nbsp;e\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;^&nbsp;e)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((combined_paths&nbsp;paths)&nbsp;*&nbsp;exts)\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.find\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(if&nbsp;case_sensitive&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_exists_case\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sys.file_exists)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alternatives\n\n\&nbsp;&nbsp;let&nbsp;which&nbsp;~ctxt&nbsp;prg&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;path_sep&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;Sys.os_type&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;\"Win32\"&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;';'\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;':'\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;path_lst&nbsp;=&nbsp;OASISString.nsplit&nbsp;(Sys.getenv&nbsp;\"PATH\")&nbsp;path_sep&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;exec_ext&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;Sys.os_type&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;\"Win32\"&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\"\"&nbsp;::&nbsp;(OASISString.nsplit&nbsp;(Sys.getenv&nbsp;\"PATHEXT\")&nbsp;path_sep)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[\"\"]\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;find_file&nbsp;~case_sensitive:false&nbsp;[path_lst;&nbsp;[prg]]&nbsp;exec_ext\n\n\&nbsp;&nbsp;(**/**)\n\&nbsp;&nbsp;let&nbsp;rec&nbsp;fix_dir&nbsp;dn&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Windows&nbsp;hack&nbsp;because&nbsp;Sys.file_exists&nbsp;\"src\\\\\"&nbsp;=&nbsp;false&nbsp;when\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sys.file_exists&nbsp;\"src\"&nbsp;=&nbsp;true\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;ln&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.length&nbsp;dn\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Sys.os_type&nbsp;=&nbsp;\"Win32\"&nbsp;&amp;&amp;&nbsp;ln&nbsp;&gt;&nbsp;0&nbsp;&amp;&amp;&nbsp;dn.[ln&nbsp;-&nbsp;1]&nbsp;=&nbsp;'\\\\'&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fix_dir&nbsp;(String.sub&nbsp;dn&nbsp;0&nbsp;(ln&nbsp;-&nbsp;1))\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dn\n\n\&nbsp;&nbsp;let&nbsp;q&nbsp;=&nbsp;Filename.quote\n\&nbsp;&nbsp;(**/**)\n\n\&nbsp;&nbsp;let&nbsp;cp&nbsp;~ctxt&nbsp;?(recurse=false)&nbsp;src&nbsp;tgt&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;recurse&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;Sys.os_type&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;\"Win32\"&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISExec.run&nbsp;~ctxt\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\"xcopy\"&nbsp;[q&nbsp;src;&nbsp;q&nbsp;tgt;&nbsp;\"/E\"]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISExec.run&nbsp;~ctxt\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\"cp\"&nbsp;[\"-r\";&nbsp;q&nbsp;src;&nbsp;q&nbsp;tgt]\n\&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISExec.run&nbsp;~ctxt\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(match&nbsp;Sys.os_type&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;\"Win32\"&nbsp;-&gt;&nbsp;\"copy\"\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;-&gt;&nbsp;\"cp\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[q&nbsp;src;&nbsp;q&nbsp;tgt]\n\n\&nbsp;&nbsp;let&nbsp;mkdir&nbsp;~ctxt&nbsp;tgt&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;OASISExec.run&nbsp;~ctxt\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(match&nbsp;Sys.os_type&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;\"Win32\"&nbsp;-&gt;&nbsp;\"md\"\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;-&gt;&nbsp;\"mkdir\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[q&nbsp;tgt]\n\n\&nbsp;&nbsp;let&nbsp;rec&nbsp;mkdir_parent&nbsp;~ctxt&nbsp;f&nbsp;tgt&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;tgt&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fix_dir&nbsp;tgt\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Sys.file_exists&nbsp;tgt&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;(Sys.is_directory&nbsp;tgt)&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISUtils.failwithf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f_&nbsp;\"Cannot&nbsp;create&nbsp;directory&nbsp;'%s',&nbsp;a&nbsp;file&nbsp;of&nbsp;the&nbsp;same&nbsp;name&nbsp;already&nbsp;\\\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exists\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tgt\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkdir_parent&nbsp;~ctxt&nbsp;f&nbsp;(Filename.dirname&nbsp;tgt);\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;(Sys.file_exists&nbsp;tgt)&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;tgt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkdir&nbsp;~ctxt&nbsp;tgt\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\n\&nbsp;&nbsp;let&nbsp;rmdir&nbsp;~ctxt&nbsp;tgt&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Sys.readdir&nbsp;tgt&nbsp;=&nbsp;[||]&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;Sys.os_type&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;\"Win32\"&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISExec.run&nbsp;~ctxt&nbsp;\"rd\"&nbsp;[q&nbsp;tgt]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISExec.run&nbsp;~ctxt&nbsp;\"rm\"&nbsp;[\"-r\";&nbsp;q&nbsp;tgt]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\n\&nbsp;&nbsp;let&nbsp;glob&nbsp;~ctxt&nbsp;fn&nbsp;=\n\&nbsp;&nbsp;&nbsp;let&nbsp;basename&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filename.basename&nbsp;fn\n\&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;String.length&nbsp;basename&nbsp;&gt;=&nbsp;2&nbsp;&amp;&amp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;basename.[0]&nbsp;=&nbsp;'*'&nbsp;&amp;&amp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;basename.[1]&nbsp;=&nbsp;'.'&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;ext_len&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(String.length&nbsp;basename)&nbsp;-&nbsp;2\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;ext&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.sub&nbsp;basename&nbsp;2&nbsp;ext_len\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;dirname&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filename.dirname&nbsp;fn\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Array.fold_left\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;acc&nbsp;fn&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;fn_ext&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.sub\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fn\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((String.length&nbsp;fn)&nbsp;-&nbsp;ext_len)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ext_len\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;fn_ext&nbsp;=&nbsp;ext&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Filename.concat&nbsp;dirname&nbsp;fn)&nbsp;::&nbsp;acc\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acc\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Invalid_argument&nbsp;_&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acc)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Sys.readdir&nbsp;dirname)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_exists_case&nbsp;fn&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[fn]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\nend\n\n"</span></code></body></html>