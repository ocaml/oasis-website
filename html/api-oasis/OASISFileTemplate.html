<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link rel="previous" href="OASISLicense.html">
<link rel="next" href="OASISBuildSection.html">
<link rel="Up" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="FormatExt" rel="Chapter" href="FormatExt.html">
<link title="FormatMarkdown" rel="Chapter" href="FormatMarkdown.html">
<link title="ODNFunc" rel="Chapter" href="ODNFunc.html">
<link title="PropList" rel="Chapter" href="PropList.html">
<link title="OASISUtils" rel="Chapter" href="OASISUtils.html">
<link title="OASISUnixPath" rel="Chapter" href="OASISUnixPath.html">
<link title="OASISContext" rel="Chapter" href="OASISContext.html">
<link title="OASISGettext" rel="Chapter" href="OASISGettext.html">
<link title="OASISMessage" rel="Chapter" href="OASISMessage.html">
<link title="OASISTypes" rel="Chapter" href="OASISTypes.html">
<link title="OASISParse" rel="Chapter" href="OASISParse.html">
<link title="OASISValues" rel="Chapter" href="OASISValues.html">
<link title="OASISExpr" rel="Chapter" href="OASISExpr.html">
<link title="OASISVersion" rel="Chapter" href="OASISVersion.html">
<link title="OASISLicense" rel="Chapter" href="OASISLicense.html">
<link title="OASISFileTemplate" rel="Chapter" href="OASISFileTemplate.html">
<link title="OASISBuildSection" rel="Chapter" href="OASISBuildSection.html">
<link title="OASISDocument" rel="Chapter" href="OASISDocument.html">
<link title="OASISExecutable" rel="Chapter" href="OASISExecutable.html">
<link title="OASISFlag" rel="Chapter" href="OASISFlag.html">
<link title="OASISLibrary" rel="Chapter" href="OASISLibrary.html">
<link title="OASISObject" rel="Chapter" href="OASISObject.html">
<link title="OASISPackage" rel="Chapter" href="OASISPackage.html">
<link title="OASISSourceRepository" rel="Chapter" href="OASISSourceRepository.html">
<link title="OASISTest" rel="Chapter" href="OASISTest.html">
<link title="OASISPlugin" rel="Chapter" href="OASISPlugin.html">
<link title="OASISFindlib" rel="Chapter" href="OASISFindlib.html">
<link title="OASISSchema" rel="Chapter" href="OASISSchema.html">
<link title="OASISSection" rel="Chapter" href="OASISSection.html">
<link title="OASISData" rel="Chapter" href="OASISData.html">
<link title="OASISString" rel="Chapter" href="OASISString.html">
<link title="OASISExec" rel="Chapter" href="OASISExec.html">
<link title="OASISFileUtil" rel="Chapter" href="OASISFileUtil.html">
<link title="OASISHostPath" rel="Chapter" href="OASISHostPath.html">
<link title="OASISGraph" rel="Chapter" href="OASISGraph.html">
<link title="BaseArgExt" rel="Chapter" href="BaseArgExt.html">
<link title="BaseBuilt" rel="Chapter" href="BaseBuilt.html">
<link title="BaseCheck" rel="Chapter" href="BaseCheck.html">
<link title="BaseCustom" rel="Chapter" href="BaseCustom.html">
<link title="BaseData" rel="Chapter" href="BaseData.html">
<link title="BaseDoc" rel="Chapter" href="BaseDoc.html">
<link title="BaseEnvLight" rel="Chapter" href="BaseEnvLight.html">
<link title="BaseEnv" rel="Chapter" href="BaseEnv.html">
<link title="BaseFileAB" rel="Chapter" href="BaseFileAB.html">
<link title="BaseGenerate" rel="Chapter" href="BaseGenerate.html">
<link title="BaseLog" rel="Chapter" href="BaseLog.html">
<link title="BaseOCamlcConfig" rel="Chapter" href="BaseOCamlcConfig.html">
<link title="BaseSetup" rel="Chapter" href="BaseSetup.html">
<link title="BaseStandardVar" rel="Chapter" href="BaseStandardVar.html">
<link title="BaseTest" rel="Chapter" href="BaseTest.html">
<link title="BaseDynVar" rel="Chapter" href="BaseDynVar.html">
<link title="BaseMessage" rel="Chapter" href="BaseMessage.html">
<link title="BaseContext" rel="Chapter" href="BaseContext.html">
<link title="SubCommand" rel="Chapter" href="SubCommand.html">
<link title="ArgExt" rel="Chapter" href="ArgExt.html">
<link title="Pager" rel="Chapter" href="Pager.html"><link title="Comments" rel="Section" href="#2_Comments">
<link title="Template" rel="Section" href="#2_Template">
<link title="File generation" rel="Section" href="#2_Filegeneration">
<link title="Multiple templates management " rel="Section" href="#2_Multipletemplatesmanagement">
<title>OASISFileTemplate</title>
</head>
<body>
<div class="navbar"><a href="OASISLicense.html">Previous</a>
&nbsp;<a href="index.html">Up</a>
&nbsp;<a href="OASISBuildSection.html">Next</a>
</div>
<center><h1>Module <a href="type_OASISFileTemplate.html">OASISFileTemplate</a></h1></center>
<br>
<pre><span class="keyword">module</span> OASISFileTemplate: <code class="code">sig</code> <a href="OASISFileTemplate.html">..</a> <code class="code">end</code></pre>Generate files replacing parts of it
<p>

    This module allow to generate files using template. Each template files
    is split into three parts: an header, a body and a footer. We target at
    changing the body part. If target file already exists, we load the header
    and the footer from it. We merge the three parts and repalce the target
    files.
<p>

    There are some safety limits:<ul>
<li>embed a digest to check nothing has changed in the body</li>
<li>if digest of the body has changed, create a backup</li>
<li>if we cannot find OASIS_START/OASIS_STOP body section, leave the
      file untouched</li>
</ul>

    The whole module is <b>not exported</b>.<br>
<b>Author(s):</b> Sylvain Le Gall<br>
<hr width="100%">
<br>
<span id="2_Comments"><h2>Comments</h2></span><br>
<pre><span id="TYPEcomment"><span class="keyword">type</span> <code class="type"></code>comment</span> </pre>
<div class="info">
Comment definition.<br>
</div>

<pre><span id="VALcomment_ml"><span class="keyword">val</span> comment_ml</span> : <code class="type"><a href="OASISFileTemplate.html#TYPEcomment">comment</a></code></pre><div class="info">
.ml comments.<br>
</div>
<pre><span id="VALcomment_sh"><span class="keyword">val</span> comment_sh</span> : <code class="type"><a href="OASISFileTemplate.html#TYPEcomment">comment</a></code></pre><div class="info">
Shell comments.<br>
</div>
<pre><span id="VALcomment_makefile"><span class="keyword">val</span> comment_makefile</span> : <code class="type"><a href="OASISFileTemplate.html#TYPEcomment">comment</a></code></pre><div class="info">
Makefile comments.<br>
</div>
<pre><span id="VALcomment_ocamlbuild"><span class="keyword">val</span> comment_ocamlbuild</span> : <code class="type"><a href="OASISFileTemplate.html#TYPEcomment">comment</a></code></pre><div class="info">
OCamlbuild comments.<br>
</div>
<pre><span id="VALcomment_bat"><span class="keyword">val</span> comment_bat</span> : <code class="type"><a href="OASISFileTemplate.html#TYPEcomment">comment</a></code></pre><div class="info">
.bat file comments.<br>
</div>
<pre><span id="VALcomment_meta"><span class="keyword">val</span> comment_meta</span> : <code class="type"><a href="OASISFileTemplate.html#TYPEcomment">comment</a></code></pre><div class="info">
META file comments.<br>
</div>
<br>
<span id="2_Template"><h2>Template</h2></span><br>
<pre><span id="TYPEline"><span class="keyword">type</span> <code class="type"></code>line</span> = <code class="type">string</code> </pre>

<br><code><span id="TYPEbody"><span class="keyword">type</span> <code class="type"></code>body</span> = </code><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span class="constructor">NoBody</span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span class="constructor">Body</span> <span class="keyword">of</span> <code class="type"><a href="OASISFileTemplate.html#TYPEline">line</a> list</code></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span class="constructor">BodyWithDigest</span> <span class="keyword">of</span> <code class="type">Digest.t * <a href="OASISFileTemplate.html#TYPEline">line</a> list</code></code></td>

</tr></table>


<br><code><span id="TYPEtemplate"><span class="keyword">type</span> <code class="type"></code>template</span> = {</code><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code>fn&nbsp;: <code class="type"><a href="OASISUnixPath.html#TYPEhost_filename">OASISUnixPath.host_filename</a></code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code>comment&nbsp;: <code class="type"><a href="OASISFileTemplate.html#TYPEcomment">comment</a></code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code>header&nbsp;: <code class="type"><a href="OASISFileTemplate.html#TYPEline">line</a> list</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code>body&nbsp;: <code class="type"><a href="OASISFileTemplate.html#TYPEbody">body</a></code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code>footer&nbsp;: <code class="type"><a href="OASISFileTemplate.html#TYPEline">line</a> list</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code>perm&nbsp;: <code class="type">int</code>;</code></td>

</tr></table>
}


<pre><span id="VALtemplate_make"><span class="keyword">val</span> template_make</span> : <code class="type"><a href="OASISUnixPath.html#TYPEhost_filename">OASISUnixPath.host_filename</a> -><br>       <a href="OASISFileTemplate.html#TYPEcomment">comment</a> -><br>       <a href="OASISFileTemplate.html#TYPEline">line</a> list -><br>       <a href="OASISFileTemplate.html#TYPEline">line</a> list -><br>       <a href="OASISFileTemplate.html#TYPEline">line</a> list -> <a href="OASISFileTemplate.html#TYPEtemplate">template</a></code></pre><div class="info">
<code class="code">template_make fn cmt header body footer</code> Create a template for which
    target file is <code class="code">fn</code>.<br>
</div>
<pre><span id="VALtemplate_of_string_list"><span class="keyword">val</span> template_of_string_list</span> : <code class="type">ctxt:<a href="OASISContext.html#TYPEt">OASISContext.t</a> -><br>       template:bool -><br>       <a href="OASISUnixPath.html#TYPEhost_filename">OASISUnixPath.host_filename</a> -><br>       <a href="OASISFileTemplate.html#TYPEcomment">comment</a> -><br>       <a href="OASISFileTemplate.html#TYPEline">line</a> list -> <a href="OASISFileTemplate.html#TYPEtemplate">template</a></code></pre><div class="info">
<code class="code">template_of_string_list ~ctxt ~template fn cmt lst</code> Split a the
    list <code class="code">lst</code> of into an header, a body and a footer, using comment
    <code class="code">cmt</code> to determine each part. Set <code class="code">~template</code> if this is an
    embedded template (i.e. not a file loaded from disk). See
    <a href="OASISFileTemplate.html#VALtemplate_make"><code class="code">OASISFileTemplate.template_make</code></a> for other options.<br>
</div>
<pre><span id="VALtemplate_of_mlfile"><span class="keyword">val</span> template_of_mlfile</span> : <code class="type"><a href="OASISUnixPath.html#TYPEhost_filename">OASISUnixPath.host_filename</a> -><br>       <a href="OASISFileTemplate.html#TYPEline">line</a> list -><br>       <a href="OASISFileTemplate.html#TYPEline">line</a> list -><br>       <a href="OASISFileTemplate.html#TYPEline">line</a> list -> <a href="OASISFileTemplate.html#TYPEtemplate">template</a></code></pre><div class="info">
<code class="code">template_of_ml_file fn</code> Create an OCaml file template taking into account
    subtleties, like line modifier. See <a href="OASISFileTemplate.html#VALtemplate_make"><code class="code">OASISFileTemplate.template_make</code></a> for other options.<br>
</div>
<br>
<span id="2_Filegeneration"><h2>File generation</h2></span><br>
<br><code><span id="TYPEfile_generate_change"><span class="keyword">type</span> <code class="type"></code>file_generate_change</span> = </code><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span class="constructor">Create</span> <span class="keyword">of</span> <code class="type"><a href="OASISUnixPath.html#TYPEhost_filename">OASISUnixPath.host_filename</a></code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><code class="code">Create fn</code>, <code class="code">fn</code> is the target file, nothing exists before</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span class="constructor">Change</span> <span class="keyword">of</span> <code class="type"><a href="OASISUnixPath.html#TYPEhost_filename">OASISUnixPath.host_filename</a> * <a href="OASISUnixPath.html#TYPEhost_filename">OASISUnixPath.host_filename</a> option</code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><code class="code">Change (fn, bak)</code>, <code class="code">bak</code> is the backup file, an existing file
      has been changed.</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span class="constructor">NoChange</span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" >Nothing done, the file doesn't need to be updated</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info">
Describe what has been done to generate a file out of a template.<br>
</div>

<pre><span id="VALfile_rollback"><span class="keyword">val</span> file_rollback</span> : <code class="type">ctxt:<a href="OASISContext.html#TYPEt">OASISContext.t</a> -> <a href="OASISFileTemplate.html#TYPEfile_generate_change">file_generate_change</a> -> unit</code></pre><div class="info">
Reset to pristine a generated file.<br>
</div>
<pre><span id="VALfile_generate"><span class="keyword">val</span> file_generate</span> : <code class="type">ctxt:<a href="OASISContext.html#TYPEt">OASISContext.t</a> -><br>       backup:bool -><br>       <a href="OASISFileTemplate.html#TYPEtemplate">template</a> -> <a href="OASISFileTemplate.html#TYPEfile_generate_change">file_generate_change</a></code></pre><div class="info">
Generate a file using a template. Only the part between OASIS_START and
    OASIS_STOP will be really replaced if the file exists. If the file doesn't
    exist use the whole template.<br>
</div>
<br>
<span id="2_Multipletemplatesmanagement"><h2>Multiple templates management </h2></span><br>
<pre><span id="EXCEPTIONAlreadyExists"><span class="keyword">exception</span> AlreadyExists</span> <span class="keyword">of</span> <code class="type"><a href="OASISUnixPath.html#TYPEhost_filename">OASISUnixPath.host_filename</a></code></pre>
<div class="info">
Try to add a file that is already in the set<br>
</div>
<pre><span id="TYPEtemplates"><span class="keyword">type</span> <code class="type"></code>templates</span> </pre>
<div class="info">
Set of templates.<br>
</div>

<pre><span id="VALempty"><span class="keyword">val</span> empty</span> : <code class="type"><a href="OASISFileTemplate.html#TYPEtemplates">templates</a></code></pre><div class="info">
No generated template files.<br>
</div>
<pre><span id="VALfind"><span class="keyword">val</span> find</span> : <code class="type"><a href="OASISUnixPath.html#TYPEhost_filename">OASISUnixPath.host_filename</a> -><br>       <a href="OASISFileTemplate.html#TYPEtemplates">templates</a> -> <a href="OASISFileTemplate.html#TYPEtemplate">template</a></code></pre><div class="info">
Find a generated template file.<br>
</div>
<pre><span id="VALadd"><span class="keyword">val</span> add</span> : <code class="type"><a href="OASISFileTemplate.html#TYPEtemplate">template</a> -><br>       <a href="OASISFileTemplate.html#TYPEtemplates">templates</a> -> <a href="OASISFileTemplate.html#TYPEtemplates">templates</a></code></pre><div class="info">
Add a generated template file.<br>
</div>
<pre><span id="VALremove"><span class="keyword">val</span> remove</span> : <code class="type"><a href="OASISUnixPath.html#TYPEhost_filename">OASISUnixPath.host_filename</a> -><br>       <a href="OASISFileTemplate.html#TYPEtemplates">templates</a> -> <a href="OASISFileTemplate.html#TYPEtemplates">templates</a></code></pre><div class="info">
Remove a generated template file.<br>
</div>
<pre><span id="VALreplace"><span class="keyword">val</span> replace</span> : <code class="type"><a href="OASISFileTemplate.html#TYPEtemplate">template</a> -><br>       <a href="OASISFileTemplate.html#TYPEtemplates">templates</a> -> <a href="OASISFileTemplate.html#TYPEtemplates">templates</a></code></pre><div class="info">
Add or replace a generated template file.<br>
</div>
<pre><span id="VALfold"><span class="keyword">val</span> fold</span> : <code class="type">(<a href="OASISFileTemplate.html#TYPEtemplate">template</a> -> 'a -> 'a) -><br>       <a href="OASISFileTemplate.html#TYPEtemplates">templates</a> -> 'a -> 'a</code></pre><div class="info">
Fold over generated template files.<br>
</div>
</body></html>