<html><head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="FormatExt" rel="Chapter" href="FormatExt.html">
<link title="FormatMarkdown" rel="Chapter" href="FormatMarkdown.html">
<link title="ODNFunc" rel="Chapter" href="ODNFunc.html">
<link title="PropList" rel="Chapter" href="PropList.html">
<link title="OASISUtils" rel="Chapter" href="OASISUtils.html">
<link title="OASISUnixPath" rel="Chapter" href="OASISUnixPath.html">
<link title="OASISContext" rel="Chapter" href="OASISContext.html">
<link title="OASISGettext" rel="Chapter" href="OASISGettext.html">
<link title="OASISMessage" rel="Chapter" href="OASISMessage.html">
<link title="OASISTypes" rel="Chapter" href="OASISTypes.html">
<link title="OASISParse" rel="Chapter" href="OASISParse.html">
<link title="OASISValues" rel="Chapter" href="OASISValues.html">
<link title="OASISExpr" rel="Chapter" href="OASISExpr.html">
<link title="OASISVersion" rel="Chapter" href="OASISVersion.html">
<link title="OASISLicense" rel="Chapter" href="OASISLicense.html">
<link title="OASISFileTemplate" rel="Chapter" href="OASISFileTemplate.html">
<link title="OASISBuildSection" rel="Chapter" href="OASISBuildSection.html">
<link title="OASISDocument" rel="Chapter" href="OASISDocument.html">
<link title="OASISExecutable" rel="Chapter" href="OASISExecutable.html">
<link title="OASISFlag" rel="Chapter" href="OASISFlag.html">
<link title="OASISLibrary" rel="Chapter" href="OASISLibrary.html">
<link title="OASISObject" rel="Chapter" href="OASISObject.html">
<link title="OASISPackage" rel="Chapter" href="OASISPackage.html">
<link title="OASISSourceRepository" rel="Chapter" href="OASISSourceRepository.html">
<link title="OASISTest" rel="Chapter" href="OASISTest.html">
<link title="OASISPlugin" rel="Chapter" href="OASISPlugin.html">
<link title="OASISFindlib" rel="Chapter" href="OASISFindlib.html">
<link title="OASISSchema" rel="Chapter" href="OASISSchema.html">
<link title="OASISSection" rel="Chapter" href="OASISSection.html">
<link title="OASISData" rel="Chapter" href="OASISData.html">
<link title="OASISString" rel="Chapter" href="OASISString.html">
<link title="OASISExec" rel="Chapter" href="OASISExec.html">
<link title="OASISFileUtil" rel="Chapter" href="OASISFileUtil.html">
<link title="OASISHostPath" rel="Chapter" href="OASISHostPath.html">
<link title="OASISGraph" rel="Chapter" href="OASISGraph.html">
<link title="BaseArgExt" rel="Chapter" href="BaseArgExt.html">
<link title="BaseBuilt" rel="Chapter" href="BaseBuilt.html">
<link title="BaseCheck" rel="Chapter" href="BaseCheck.html">
<link title="BaseCustom" rel="Chapter" href="BaseCustom.html">
<link title="BaseData" rel="Chapter" href="BaseData.html">
<link title="BaseDoc" rel="Chapter" href="BaseDoc.html">
<link title="BaseEnvLight" rel="Chapter" href="BaseEnvLight.html">
<link title="BaseEnv" rel="Chapter" href="BaseEnv.html">
<link title="BaseFileAB" rel="Chapter" href="BaseFileAB.html">
<link title="BaseGenerate" rel="Chapter" href="BaseGenerate.html">
<link title="BaseLog" rel="Chapter" href="BaseLog.html">
<link title="BaseOCamlcConfig" rel="Chapter" href="BaseOCamlcConfig.html">
<link title="BaseSetup" rel="Chapter" href="BaseSetup.html">
<link title="BaseStandardVar" rel="Chapter" href="BaseStandardVar.html">
<link title="BaseTest" rel="Chapter" href="BaseTest.html">
<link title="BaseDynVar" rel="Chapter" href="BaseDynVar.html">
<link title="BaseMessage" rel="Chapter" href="BaseMessage.html">
<link title="BaseContext" rel="Chapter" href="BaseContext.html">
<link title="SubCommand" rel="Chapter" href="SubCommand.html">
<link title="ArgExt" rel="Chapter" href="ArgExt.html">
<link title="Pager" rel="Chapter" href="Pager.html"><title>ArgExt.pp_print_help</title>
</head>
<body>
<code class="code"><span class="keyword">let</span>&nbsp;pp_print_help&nbsp;hext&nbsp;hsty&nbsp;fmt&nbsp;()&nbsp;=<br>
<br>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Print&nbsp;with&nbsp;a&nbsp;precise&nbsp;length&nbsp;*)</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pp_print_justified&nbsp;sz&nbsp;fmt&nbsp;str&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ns&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">String</span>.make&nbsp;sz&nbsp;<span class="string">'&nbsp;'</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">String</span>.blit&nbsp;str&nbsp;0&nbsp;ns&nbsp;0&nbsp;(<span class="constructor">String</span>.length&nbsp;str);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pp_print_string&nbsp;fmt&nbsp;ns<br>
&nbsp;&nbsp;<span class="keyword">in</span><br>
<br>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Print&nbsp;definition&nbsp;for&nbsp;the&nbsp;output&nbsp;style&nbsp;*)</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pp_print_output_def&nbsp;sz&nbsp;fmt&nbsp;(term,&nbsp;def)&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;pp_print_string&nbsp;fmt&nbsp;<span class="string">"&nbsp;&nbsp;"</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;pp_print_justified&nbsp;sz&nbsp;fmt&nbsp;term;<br>
&nbsp;&nbsp;&nbsp;&nbsp;pp_print_string&nbsp;fmt&nbsp;<span class="string">"&nbsp;&nbsp;"</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;pp_open_box&nbsp;fmt&nbsp;0;<br>
&nbsp;&nbsp;&nbsp;&nbsp;pp_print_string_spaced&nbsp;fmt&nbsp;def;<br>
&nbsp;&nbsp;&nbsp;&nbsp;pp_close_box&nbsp;fmt&nbsp;();<br>
&nbsp;&nbsp;&nbsp;&nbsp;pp_print_newline&nbsp;fmt&nbsp;()<br>
&nbsp;&nbsp;<span class="keyword">in</span><br>
<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pp_print_specs&nbsp;spec_help&nbsp;fmt&nbsp;specs&nbsp;=<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;help_specs&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">List</span>.rev_append<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="constructor">List</span>.rev_map<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">fun</span>&nbsp;(cli,&nbsp;t,&nbsp;hlp)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;arg,&nbsp;hlp&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;<span class="constructor">OASISString</span>.nsplit&nbsp;hlp&nbsp;<span class="string">'&nbsp;'</span>&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;hd&nbsp;::&nbsp;tl&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hd,&nbsp;(<span class="constructor">String</span>.concat&nbsp;<span class="string">"&nbsp;"</span>&nbsp;tl)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">""</span>,&nbsp;<span class="string">""</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;arg&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;t&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Arg</span>.<span class="constructor">Symbol</span>&nbsp;(lst,&nbsp;_)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"{"</span>^(<span class="constructor">String</span>.concat&nbsp;<span class="string">"|"</span>&nbsp;lst)^<span class="string">"}"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;term&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;arg&nbsp;&lt;&gt;&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cli^<span class="string">"&nbsp;"</span>^arg<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cli<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;term,&nbsp;hlp)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;specs)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">if</span>&nbsp;spec_help&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="string">"-help|--help"</span>,&nbsp;s_&nbsp;<span class="string">"Display&nbsp;this&nbsp;list&nbsp;of&nbsp;options"</span>]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[])<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">in</span><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sz&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">List</span>.fold_left<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">fun</span>&nbsp;acc&nbsp;(s,&nbsp;_)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;max&nbsp;(<span class="constructor">String</span>.length&nbsp;s)&nbsp;acc)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help_specs<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">in</span><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pp_print_spec&nbsp;fmt&nbsp;(term,&nbsp;hlp)&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;hsty&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Markdown</span>&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pp_print_def&nbsp;fmt<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="string">"`"</span>^term^<span class="string">"`"</span>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[pp_print_string_spaced,&nbsp;hlp]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Output</span>&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pp_print_output_def<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sz&nbsp;fmt&nbsp;(term,&nbsp;hlp)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">in</span><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pp_print_list&nbsp;pp_print_spec&nbsp;<span class="string">""</span>&nbsp;fmt&nbsp;help_specs;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;hsty&nbsp;=&nbsp;<span class="constructor">Output</span>&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pp_print_newline&nbsp;fmt&nbsp;()<br>
&nbsp;&nbsp;<span class="keyword">in</span><br>
<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pp_print_scmds&nbsp;fmt&nbsp;()&nbsp;=<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sz&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">SubCommand</span>.fold<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">fun</span>&nbsp;c&nbsp;sz&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max&nbsp;sz&nbsp;(<span class="constructor">String</span>.length&nbsp;c.scmd_name))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pp_print_para&nbsp;fmt&nbsp;(s_&nbsp;<span class="string">"Available&nbsp;subcommands:"</span>);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">SubCommand</span>.fold<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">fun</span>&nbsp;c&nbsp;()&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;hsty&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Markdown</span>&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pp_print_def&nbsp;fmt&nbsp;(<span class="string">"`"</span>^c.scmd_name^<span class="string">"`"</span>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[pp_print_string_spaced,&nbsp;c.scmd_synopsis]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Output</span>&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pp_print_output_def<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sz&nbsp;fmt&nbsp;(c.scmd_name,&nbsp;c.scmd_synopsis))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;hsty&nbsp;=&nbsp;<span class="constructor">Output</span>&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pp_print_newline&nbsp;fmt&nbsp;()<br>
&nbsp;&nbsp;<span class="keyword">in</span><br>
<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pp_print_scmd&nbsp;fmt&nbsp;~global_options&nbsp;scmd&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;pp_print_title&nbsp;2&nbsp;fmt<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="constructor">Printf</span>.sprintf&nbsp;(f_&nbsp;<span class="string">"Subcommand&nbsp;%s"</span>)&nbsp;scmd.scmd_name);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;pp_print_string&nbsp;fmt&nbsp;scmd.scmd_help;<br>
&nbsp;&nbsp;&nbsp;&nbsp;pp_print_endblock<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~check_last_char:scmd.scmd_help<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fmt&nbsp;();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;fprintf&nbsp;fmt&nbsp;(f_&nbsp;<span class="string">"Usage:&nbsp;oasis&nbsp;[global-options*]&nbsp;%s&nbsp;%s"</span>)&nbsp;scmd.scmd_name&nbsp;scmd.scmd_usage;<br>
&nbsp;&nbsp;&nbsp;&nbsp;pp_print_endblock&nbsp;fmt&nbsp;();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;global_options&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pp_print_para&nbsp;fmt&nbsp;(s_&nbsp;<span class="string">"Global&nbsp;options:&nbsp;"</span>);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pp_print_specs&nbsp;<span class="keyword">true</span>&nbsp;fmt&nbsp;specs<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;scmd.scmd_specs&nbsp;&lt;&gt;&nbsp;[]&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pp_print_para&nbsp;fmt&nbsp;(s_&nbsp;<span class="string">"Options:&nbsp;"</span>);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pp_print_specs&nbsp;<span class="keyword">false</span>&nbsp;fmt&nbsp;scmd.scmd_specs<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;<span class="keyword">in</span><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;hext&nbsp;<span class="keyword">with</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">NoSubCommand</span>&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">AllSubCommand</span>&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pp_print_string&nbsp;fmt&nbsp;usage_msg;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pp_print_endblock&nbsp;fmt&nbsp;();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pp_print_string&nbsp;fmt&nbsp;<span class="constructor">CLIData</span>.main_mkd;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pp_print_endblock<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~check_last_char:<span class="constructor">CLIData</span>.main_mkd<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fmt&nbsp;();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pp_print_specs&nbsp;<span class="keyword">true</span>&nbsp;fmt&nbsp;specs;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pp_print_scmds&nbsp;fmt&nbsp;();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">SubCommand</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;()<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;hext&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">NoSubCommand</span>&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;()<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">SubCommand</span>&nbsp;nm&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pp_print_scmd&nbsp;fmt<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~global_options:<span class="keyword">true</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="constructor">SubCommand</span>.find&nbsp;nm)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">AllSubCommand</span>&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">SubCommand</span>.fold<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">fun</span>&nbsp;scmd&nbsp;()&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pp_print_scmd&nbsp;fmt&nbsp;~global_options:<span class="keyword">false</span>&nbsp;scmd)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;()<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></code></body></html>