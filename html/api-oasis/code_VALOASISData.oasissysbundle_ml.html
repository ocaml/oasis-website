<html><head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="FormatExt" rel="Chapter" href="FormatExt.html">
<link title="FormatMarkdown" rel="Chapter" href="FormatMarkdown.html">
<link title="ODNFunc" rel="Chapter" href="ODNFunc.html">
<link title="PropList" rel="Chapter" href="PropList.html">
<link title="OASISUtils" rel="Chapter" href="OASISUtils.html">
<link title="OASISUnixPath" rel="Chapter" href="OASISUnixPath.html">
<link title="OASISContext" rel="Chapter" href="OASISContext.html">
<link title="OASISGettext" rel="Chapter" href="OASISGettext.html">
<link title="OASISMessage" rel="Chapter" href="OASISMessage.html">
<link title="OASISTypes" rel="Chapter" href="OASISTypes.html">
<link title="OASISParse" rel="Chapter" href="OASISParse.html">
<link title="OASISValues" rel="Chapter" href="OASISValues.html">
<link title="OASISExpr" rel="Chapter" href="OASISExpr.html">
<link title="OASISVersion" rel="Chapter" href="OASISVersion.html">
<link title="OASISLicense" rel="Chapter" href="OASISLicense.html">
<link title="OASISFileTemplate" rel="Chapter" href="OASISFileTemplate.html">
<link title="OASISBuildSection" rel="Chapter" href="OASISBuildSection.html">
<link title="OASISDocument" rel="Chapter" href="OASISDocument.html">
<link title="OASISExecutable" rel="Chapter" href="OASISExecutable.html">
<link title="OASISFlag" rel="Chapter" href="OASISFlag.html">
<link title="OASISLibrary" rel="Chapter" href="OASISLibrary.html">
<link title="OASISObject" rel="Chapter" href="OASISObject.html">
<link title="OASISPackage" rel="Chapter" href="OASISPackage.html">
<link title="OASISSourceRepository" rel="Chapter" href="OASISSourceRepository.html">
<link title="OASISTest" rel="Chapter" href="OASISTest.html">
<link title="OASISPlugin" rel="Chapter" href="OASISPlugin.html">
<link title="OASISFindlib" rel="Chapter" href="OASISFindlib.html">
<link title="OASISSchema" rel="Chapter" href="OASISSchema.html">
<link title="OASISSection" rel="Chapter" href="OASISSection.html">
<link title="OASISData" rel="Chapter" href="OASISData.html">
<link title="OASISString" rel="Chapter" href="OASISString.html">
<link title="OASISExec" rel="Chapter" href="OASISExec.html">
<link title="OASISFileUtil" rel="Chapter" href="OASISFileUtil.html">
<link title="OASISHostPath" rel="Chapter" href="OASISHostPath.html">
<link title="OASISGraph" rel="Chapter" href="OASISGraph.html">
<link title="BaseArgExt" rel="Chapter" href="BaseArgExt.html">
<link title="BaseBuilt" rel="Chapter" href="BaseBuilt.html">
<link title="BaseCheck" rel="Chapter" href="BaseCheck.html">
<link title="BaseCustom" rel="Chapter" href="BaseCustom.html">
<link title="BaseData" rel="Chapter" href="BaseData.html">
<link title="BaseDoc" rel="Chapter" href="BaseDoc.html">
<link title="BaseEnvLight" rel="Chapter" href="BaseEnvLight.html">
<link title="BaseEnv" rel="Chapter" href="BaseEnv.html">
<link title="BaseFileAB" rel="Chapter" href="BaseFileAB.html">
<link title="BaseGenerate" rel="Chapter" href="BaseGenerate.html">
<link title="BaseLog" rel="Chapter" href="BaseLog.html">
<link title="BaseOCamlcConfig" rel="Chapter" href="BaseOCamlcConfig.html">
<link title="BaseSetup" rel="Chapter" href="BaseSetup.html">
<link title="BaseStandardVar" rel="Chapter" href="BaseStandardVar.html">
<link title="BaseTest" rel="Chapter" href="BaseTest.html">
<link title="BaseDynVar" rel="Chapter" href="BaseDynVar.html">
<link title="BaseMessage" rel="Chapter" href="BaseMessage.html">
<link title="BaseContext" rel="Chapter" href="BaseContext.html">
<link title="SubCommand" rel="Chapter" href="SubCommand.html">
<link title="ArgExt" rel="Chapter" href="ArgExt.html">
<link title="Pager" rel="Chapter" href="Pager.html"><title>OASISData.oasissysbundle_ml</title>
</head>
<body>
<code class="code"><span class="keyword">let</span>&nbsp;oasissysbundle_ml&nbsp;=&nbsp;<br>
&nbsp;&nbsp;<span class="string">"module&nbsp;OASISGettext&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISGettext.ml\"\n\n\&nbsp;&nbsp;let&nbsp;ns_&nbsp;str&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;str\n\n\&nbsp;&nbsp;let&nbsp;s_&nbsp;str&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;str\n\n\&nbsp;&nbsp;let&nbsp;f_&nbsp;(str&nbsp;:&nbsp;('a,&nbsp;'b,&nbsp;'c,&nbsp;'d)&nbsp;format4)&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;str\n\n\&nbsp;&nbsp;let&nbsp;fn_&nbsp;fmt1&nbsp;fmt2&nbsp;n&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;=&nbsp;1&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fmt1^^\"\"\n\&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fmt2^^\"\"\n\n\&nbsp;&nbsp;let&nbsp;init&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;[]\n\nend\n\nmodule&nbsp;OASISContext&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISContext.ml\"\n\n\&nbsp;&nbsp;open&nbsp;OASISGettext\n\n\&nbsp;&nbsp;type&nbsp;level&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;`Debug\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Info\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Warning\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Error]\n\n\&nbsp;&nbsp;type&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiet:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;info:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ignore_plugins:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ignore_unknown_fields:&nbsp;bool;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;level&nbsp;-&gt;&nbsp;string&nbsp;-&gt;&nbsp;unit;\n\&nbsp;&nbsp;&nbsp;&nbsp;}\n\n\&nbsp;&nbsp;let&nbsp;printf&nbsp;lvl&nbsp;str&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;beg&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;lvl&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Error&nbsp;-&gt;&nbsp;s_&nbsp;\"E:&nbsp;\"\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Warning&nbsp;-&gt;&nbsp;s_&nbsp;\"W:&nbsp;\"\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Info&nbsp;&nbsp;-&gt;&nbsp;s_&nbsp;\"I:&nbsp;\"\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Debug&nbsp;-&gt;&nbsp;s_&nbsp;\"D:&nbsp;\"\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prerr_endline&nbsp;(beg^str)\n\n\&nbsp;&nbsp;let&nbsp;default&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;ref\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;false;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;info&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;false;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;false;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ignore_plugins&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;false;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ignore_unknown_fields&nbsp;=&nbsp;false;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;printf;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n\&nbsp;&nbsp;let&nbsp;quiet&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;{!default&nbsp;with&nbsp;quiet&nbsp;=&nbsp;true}\n\n\n\&nbsp;&nbsp;let&nbsp;args&nbsp;()&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;[\"-quiet\",\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arg.Unit&nbsp;(fun&nbsp;()&nbsp;-&gt;&nbsp;default&nbsp;:=&nbsp;{!default&nbsp;with&nbsp;quiet&nbsp;=&nbsp;true}),\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(s_&nbsp;\"&nbsp;Run&nbsp;quietly\");\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\"-info\",\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arg.Unit&nbsp;(fun&nbsp;()&nbsp;-&gt;&nbsp;default&nbsp;:=&nbsp;{!default&nbsp;with&nbsp;info&nbsp;=&nbsp;true}),\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(s_&nbsp;\"&nbsp;Display&nbsp;information&nbsp;message\");\n\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\"-debug\",\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arg.Unit&nbsp;(fun&nbsp;()&nbsp;-&gt;&nbsp;default&nbsp;:=&nbsp;{!default&nbsp;with&nbsp;debug&nbsp;=&nbsp;true}),\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(s_&nbsp;\"&nbsp;Output&nbsp;debug&nbsp;message\")]\nend\n\nmodule&nbsp;OASISString&nbsp;=&nbsp;struct\n#&nbsp;1&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISString.ml\"\n\n\n\n\&nbsp;&nbsp;(**&nbsp;Various&nbsp;string&nbsp;utilities.\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mostly&nbsp;inspired&nbsp;by&nbsp;extlib&nbsp;and&nbsp;batteries&nbsp;ExtString&nbsp;and&nbsp;BatString&nbsp;libraries.\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@author&nbsp;Sylvain&nbsp;Le&nbsp;Gall\n\&nbsp;&nbsp;&nbsp;&nbsp;*)\n\n\&nbsp;&nbsp;let&nbsp;nsplitf&nbsp;str&nbsp;f&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;str&nbsp;=&nbsp;\"\"&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]\n\&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;buf&nbsp;=&nbsp;Buffer.create&nbsp;13&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;lst&nbsp;=&nbsp;ref&nbsp;[]&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;push&nbsp;()&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lst&nbsp;:=&nbsp;Buffer.contents&nbsp;buf&nbsp;::&nbsp;!lst;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Buffer.clear&nbsp;buf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;str_len&nbsp;=&nbsp;String.length&nbsp;str&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;=&nbsp;0&nbsp;to&nbsp;str_len&nbsp;-&nbsp;1&nbsp;do\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;f&nbsp;str.[i]&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;()\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Buffer.add_char&nbsp;buf&nbsp;str.[i]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;();\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.rev&nbsp;!lst\n\n\&nbsp;&nbsp;(**&nbsp;[nsplit&nbsp;c&nbsp;s]&nbsp;Split&nbsp;the&nbsp;string&nbsp;[s]&nbsp;at&nbsp;char&nbsp;[c].&nbsp;It&nbsp;doesn't&nbsp;include&nbsp;the\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;separator.\n\&nbsp;&nbsp;&nbsp;&nbsp;*)\n\&nbsp;&nbsp;let&nbsp;nsplit&nbsp;str&nbsp;c&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;nsplitf&nbsp;str&nbsp;((=)&nbsp;c)\n\n\&nbsp;&nbsp;let&nbsp;find&nbsp;~what&nbsp;?(offset=0)&nbsp;str&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;what_idx&nbsp;=&nbsp;ref&nbsp;0&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;str_idx&nbsp;=&nbsp;ref&nbsp;offset&nbsp;in&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;!str_idx&nbsp;&lt;&nbsp;String.length&nbsp;str&nbsp;&amp;&amp;&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!what_idx&nbsp;&lt;&nbsp;String.length&nbsp;what&nbsp;do\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;str.[!str_idx]&nbsp;=&nbsp;what.[!what_idx]&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incr&nbsp;what_idx\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;what_idx&nbsp;:=&nbsp;0;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incr&nbsp;str_idx\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;!what_idx&nbsp;&lt;&gt;&nbsp;String.length&nbsp;what&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;Not_found\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!str_idx&nbsp;-&nbsp;!what_idx\n\n\&nbsp;&nbsp;let&nbsp;sub_start&nbsp;str&nbsp;len&nbsp;=&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;str_len&nbsp;=&nbsp;String.length&nbsp;str&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len&nbsp;&gt;=&nbsp;str_len&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\"\"\n\&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.sub&nbsp;str&nbsp;len&nbsp;(str_len&nbsp;-&nbsp;len)\n\n\&nbsp;&nbsp;let&nbsp;sub_end&nbsp;?(offset=0)&nbsp;str&nbsp;len&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;str_len&nbsp;=&nbsp;String.length&nbsp;str&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len&nbsp;&gt;=&nbsp;str_len&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\"\"\n\&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.sub&nbsp;str&nbsp;0&nbsp;(str_len&nbsp;-&nbsp;len)\n\n\&nbsp;&nbsp;let&nbsp;starts_with&nbsp;~what&nbsp;?(offset=0)&nbsp;str&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;what_idx&nbsp;=&nbsp;ref&nbsp;0&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;str_idx&nbsp;=&nbsp;ref&nbsp;offset&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;ok&nbsp;=&nbsp;ref&nbsp;true&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;!ok&nbsp;&amp;&amp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!str_idx&nbsp;&lt;&nbsp;String.length&nbsp;str&nbsp;&amp;&amp;&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!what_idx&nbsp;&lt;&nbsp;String.length&nbsp;what&nbsp;do\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;str.[!str_idx]&nbsp;=&nbsp;what.[!what_idx]&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incr&nbsp;what_idx\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;:=&nbsp;false;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incr&nbsp;str_idx\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;!what_idx&nbsp;=&nbsp;String.length&nbsp;what&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;true\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false\n\n\&nbsp;&nbsp;let&nbsp;strip_starts_with&nbsp;~what&nbsp;str&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;starts_with&nbsp;~what&nbsp;str&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_start&nbsp;str&nbsp;(String.length&nbsp;what)\n\&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;Not_found\n\n\&nbsp;&nbsp;let&nbsp;ends_with&nbsp;~what&nbsp;?(offset=0)&nbsp;str&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;what_idx&nbsp;=&nbsp;ref&nbsp;((String.length&nbsp;what)&nbsp;-&nbsp;1)&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;str_idx&nbsp;=&nbsp;ref&nbsp;((String.length&nbsp;str)&nbsp;-&nbsp;1)&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;ok&nbsp;=&nbsp;ref&nbsp;true&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;!ok&nbsp;&amp;&amp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offset&nbsp;&lt;=&nbsp;!str_idx&nbsp;&amp;&amp;&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&lt;=&nbsp;!what_idx&nbsp;do\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;str.[!str_idx]&nbsp;=&nbsp;what.[!what_idx]&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decr&nbsp;what_idx\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;:=&nbsp;false;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decr&nbsp;str_idx\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;!what_idx&nbsp;=&nbsp;-1&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;true\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false\n\n\&nbsp;&nbsp;let&nbsp;strip_ends_with&nbsp;~what&nbsp;str&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ends_with&nbsp;~what&nbsp;str&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_end&nbsp;str&nbsp;(String.length&nbsp;what)\n\&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;Not_found\n\n\&nbsp;&nbsp;let&nbsp;replace_chars&nbsp;f&nbsp;s&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;buf&nbsp;=&nbsp;String.make&nbsp;(String.length&nbsp;s)&nbsp;'X'&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;=&nbsp;0&nbsp;to&nbsp;String.length&nbsp;s&nbsp;-&nbsp;1&nbsp;do\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf.[i]&nbsp;&lt;-&nbsp;f&nbsp;s.[i]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf\n\nend\n\nmodule&nbsp;OASISUtils&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISUtils.ml\"\n\n\&nbsp;&nbsp;open&nbsp;OASISGettext\n\n\&nbsp;&nbsp;module&nbsp;MapString&nbsp;=&nbsp;Map.Make(String)\n\n\&nbsp;&nbsp;let&nbsp;map_string_of_assoc&nbsp;assoc&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;List.fold_left\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;acc&nbsp;(k,&nbsp;v)&nbsp;-&gt;&nbsp;MapString.add&nbsp;k&nbsp;v&nbsp;acc)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MapString.empty\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assoc\n\n\&nbsp;&nbsp;module&nbsp;SetString&nbsp;=&nbsp;Set.Make(String)\n\n\&nbsp;&nbsp;let&nbsp;set_string_add_list&nbsp;st&nbsp;lst&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;List.fold_left\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;acc&nbsp;e&nbsp;-&gt;&nbsp;SetString.add&nbsp;e&nbsp;acc)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;st\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lst\n\n\&nbsp;&nbsp;let&nbsp;set_string_of_list&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;set_string_add_list\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetString.empty\n\n\n\&nbsp;&nbsp;let&nbsp;compare_csl&nbsp;s1&nbsp;s2&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;String.compare&nbsp;(String.lowercase&nbsp;s1)&nbsp;(String.lowercase&nbsp;s2)\n\n\&nbsp;&nbsp;module&nbsp;HashStringCsl&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;Hashtbl.Make\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(struct\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;t&nbsp;=&nbsp;string\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;equal&nbsp;s1&nbsp;s2&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(String.lowercase&nbsp;s1)&nbsp;=&nbsp;(String.lowercase&nbsp;s2)\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;hash&nbsp;s&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hashtbl.hash&nbsp;(String.lowercase&nbsp;s)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end)\n\n\&nbsp;&nbsp;let&nbsp;varname_of_string&nbsp;?(hyphen='_')&nbsp;s&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;String.length&nbsp;s&nbsp;=&nbsp;0&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invalid_arg&nbsp;\"varname_of_string\"\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;buf&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISString.replace_chars\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;c&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;('a'&nbsp;&lt;=&nbsp;c&nbsp;&amp;&amp;&nbsp;c&nbsp;&lt;=&nbsp;'z')\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;('A'&nbsp;&lt;=&nbsp;c&nbsp;&amp;&amp;&nbsp;c&nbsp;&lt;=&nbsp;'Z')\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;('0'&nbsp;&lt;=&nbsp;c&nbsp;&amp;&amp;&nbsp;c&nbsp;&lt;=&nbsp;'9')&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hyphen)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;buf&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Start&nbsp;with&nbsp;a&nbsp;_&nbsp;if&nbsp;digit&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;'0'&nbsp;&lt;=&nbsp;s.[0]&nbsp;&amp;&amp;&nbsp;s.[0]&nbsp;&lt;=&nbsp;'9'&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\"_\"^buf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.lowercase&nbsp;buf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\n\&nbsp;&nbsp;let&nbsp;varname_concat&nbsp;?(hyphen='_')&nbsp;p&nbsp;s&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;what&nbsp;=&nbsp;String.make&nbsp;1&nbsp;hyphen&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;p&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISString.strip_ends_with&nbsp;~what&nbsp;p\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Not_found&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;s&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISString.strip_starts_with&nbsp;~what&nbsp;s\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Not_found&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p^what^s\n\n\n\&nbsp;&nbsp;let&nbsp;is_varname&nbsp;str&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;str&nbsp;=&nbsp;varname_of_string&nbsp;str\n\n\&nbsp;&nbsp;let&nbsp;failwithf&nbsp;fmt&nbsp;=&nbsp;Printf.ksprintf&nbsp;failwith&nbsp;fmt\n\nend\n\nmodule&nbsp;PropList&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/PropList.ml\"\n\n\&nbsp;&nbsp;open&nbsp;OASISGettext\n\n\&nbsp;&nbsp;type&nbsp;name&nbsp;=&nbsp;string\n\n\&nbsp;&nbsp;exception&nbsp;Not_set&nbsp;of&nbsp;name&nbsp;*&nbsp;string&nbsp;option\n\&nbsp;&nbsp;exception&nbsp;No_printer&nbsp;of&nbsp;name\n\&nbsp;&nbsp;exception&nbsp;Unknown_field&nbsp;of&nbsp;name&nbsp;*&nbsp;name\n\n\&nbsp;&nbsp;let&nbsp;()&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;Printexc.register_printer\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(function\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Not_set&nbsp;(nm,&nbsp;Some&nbsp;rsn)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Printf.sprintf&nbsp;(f_&nbsp;\"Field&nbsp;'%s'&nbsp;is&nbsp;not&nbsp;set:&nbsp;%s\")&nbsp;nm&nbsp;rsn)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Not_set&nbsp;(nm,&nbsp;None)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Printf.sprintf&nbsp;(f_&nbsp;\"Field&nbsp;'%s'&nbsp;is&nbsp;not&nbsp;set\")&nbsp;nm)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;No_printer&nbsp;nm&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Some\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Printf.sprintf&nbsp;(f_&nbsp;\"No&nbsp;default&nbsp;printer&nbsp;for&nbsp;value&nbsp;%s\")&nbsp;nm)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Unknown_field&nbsp;(nm,&nbsp;schm)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Printf.sprintf&nbsp;(f_&nbsp;\"Field&nbsp;%s&nbsp;is&nbsp;not&nbsp;defined&nbsp;in&nbsp;schema&nbsp;%s\")&nbsp;nm&nbsp;schm)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None)\n\n\&nbsp;&nbsp;module&nbsp;Data&nbsp;=\n\&nbsp;&nbsp;struct\n\n\&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(name,&nbsp;unit&nbsp;-&gt;&nbsp;unit)&nbsp;Hashtbl.t\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;create&nbsp;()&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hashtbl.create&nbsp;13\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;clear&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hashtbl.clear&nbsp;t\n\n#&nbsp;71&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/PropList.ml\"\n\&nbsp;&nbsp;end\n\n\&nbsp;&nbsp;module&nbsp;Schema&nbsp;=\n\&nbsp;&nbsp;struct\n\n\&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;('ctxt,&nbsp;'extra)&nbsp;value&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get:&nbsp;&nbsp;&nbsp;Data.t&nbsp;-&gt;&nbsp;string;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set:&nbsp;&nbsp;&nbsp;Data.t&nbsp;-&gt;&nbsp;?context:'ctxt&nbsp;-&gt;&nbsp;string&nbsp;-&gt;&nbsp;unit;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help:&nbsp;&nbsp;(unit&nbsp;-&gt;&nbsp;string)&nbsp;option;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extra:&nbsp;'extra;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n\&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;('ctxt,&nbsp;'extra)&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fields:&nbsp;&nbsp;&nbsp;&nbsp;(name,&nbsp;('ctxt,&nbsp;'extra)&nbsp;value)&nbsp;Hashtbl.t;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;order:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;Queue.t;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_norm:&nbsp;string&nbsp;-&gt;&nbsp;string;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;create&nbsp;?(case_insensitive=false)&nbsp;nm&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;nm;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fields&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;Hashtbl.create&nbsp;13;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;order&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;Queue.create&nbsp;();\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_norm&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(if&nbsp;case_insensitive&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.lowercase\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;s&nbsp;-&gt;&nbsp;s);\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;add&nbsp;t&nbsp;nm&nbsp;set&nbsp;get&nbsp;extra&nbsp;help&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;key&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.name_norm&nbsp;nm\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Hashtbl.mem&nbsp;t.fields&nbsp;key&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;failwith\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Printf.sprintf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f_&nbsp;\"Field&nbsp;'%s'&nbsp;is&nbsp;already&nbsp;defined&nbsp;in&nbsp;schema&nbsp;'%s'\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nm&nbsp;t.name);\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hashtbl.add\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.fields\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&nbsp;&nbsp;=&nbsp;set;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get&nbsp;&nbsp;&nbsp;=&nbsp;get;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help&nbsp;&nbsp;=&nbsp;help;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extra&nbsp;=&nbsp;extra;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Queue.add&nbsp;nm&nbsp;t.order\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;mem&nbsp;t&nbsp;nm&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hashtbl.mem&nbsp;t.fields&nbsp;nm\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;find&nbsp;t&nbsp;nm&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hashtbl.find&nbsp;t.fields&nbsp;(t.name_norm&nbsp;nm)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Not_found&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;(Unknown_field&nbsp;(nm,&nbsp;t.name))\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;get&nbsp;t&nbsp;data&nbsp;nm&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(find&nbsp;t&nbsp;nm).get&nbsp;data\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;set&nbsp;t&nbsp;data&nbsp;nm&nbsp;?context&nbsp;x&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(find&nbsp;t&nbsp;nm).set\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?context\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;fold&nbsp;f&nbsp;acc&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Queue.fold\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;acc&nbsp;k&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;v&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;find&nbsp;t&nbsp;k\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;acc&nbsp;k&nbsp;v.extra&nbsp;v.help)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acc\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.order\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;iter&nbsp;f&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fold\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;()&nbsp;-&gt;&nbsp;f)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;()\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;name&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.name\n\&nbsp;&nbsp;end\n\n\&nbsp;&nbsp;module&nbsp;Field&nbsp;=\n\&nbsp;&nbsp;struct\n\n\&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;('ctxt,&nbsp;'value,&nbsp;'extra)&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set:&nbsp;&nbsp;&nbsp;&nbsp;Data.t&nbsp;-&gt;&nbsp;?context:'ctxt&nbsp;-&gt;&nbsp;'value&nbsp;-&gt;&nbsp;unit;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get:&nbsp;&nbsp;&nbsp;&nbsp;Data.t&nbsp;-&gt;&nbsp;'value;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sets:&nbsp;&nbsp;&nbsp;Data.t&nbsp;-&gt;&nbsp;?context:'ctxt&nbsp;-&gt;&nbsp;string&nbsp;-&gt;&nbsp;unit;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gets:&nbsp;&nbsp;&nbsp;Data.t&nbsp;-&gt;&nbsp;string;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help:&nbsp;&nbsp;&nbsp;(unit&nbsp;-&gt;&nbsp;string)&nbsp;option;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extra:&nbsp;&nbsp;'extra;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;new_id&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;last_id&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ref&nbsp;0\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;()&nbsp;-&gt;&nbsp;incr&nbsp;last_id;&nbsp;!last_id\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;create&nbsp;?schema&nbsp;?name&nbsp;?parse&nbsp;?print&nbsp;?default&nbsp;?update&nbsp;?help&nbsp;extra&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Default&nbsp;value&nbsp;container&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;v&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ref&nbsp;None\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;If&nbsp;name&nbsp;is&nbsp;not&nbsp;given,&nbsp;create&nbsp;unique&nbsp;one&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;nm&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;name&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;s&nbsp;-&gt;&nbsp;s\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;-&gt;&nbsp;Printf.sprintf&nbsp;\"_anon_%d\"&nbsp;(new_id&nbsp;())\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Last&nbsp;chance&nbsp;to&nbsp;get&nbsp;a&nbsp;value:&nbsp;the&nbsp;default&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;default&nbsp;()&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;default&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;d&nbsp;-&gt;&nbsp;d\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;-&gt;&nbsp;raise&nbsp;(Not_set&nbsp;(nm,&nbsp;Some&nbsp;(s_&nbsp;\"no&nbsp;default&nbsp;value\")))\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Get&nbsp;data&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;get&nbsp;data&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Get&nbsp;value&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Hashtbl.find&nbsp;data&nbsp;nm)&nbsp;();\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;!v&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;x&nbsp;-&gt;&nbsp;x\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;-&gt;&nbsp;default&nbsp;()\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Not_found&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default&nbsp;()\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Set&nbsp;data&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;set&nbsp;data&nbsp;?context&nbsp;x&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;x&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;update&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;f&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;?context&nbsp;(get&nbsp;data)&nbsp;x\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Not_set&nbsp;_&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hashtbl.replace\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nm\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;()&nbsp;-&gt;&nbsp;v&nbsp;:=&nbsp;Some&nbsp;x)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Parse&nbsp;string&nbsp;value,&nbsp;if&nbsp;possible&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;parse&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;parse&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;f&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;?context&nbsp;s&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;failwith\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Printf.sprintf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f_&nbsp;\"Cannot&nbsp;parse&nbsp;field&nbsp;'%s'&nbsp;when&nbsp;setting&nbsp;value&nbsp;%S\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nm\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Set&nbsp;data,&nbsp;from&nbsp;string&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;sets&nbsp;data&nbsp;?context&nbsp;s&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;?context&nbsp;data&nbsp;(parse&nbsp;?context&nbsp;s)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Output&nbsp;value&nbsp;as&nbsp;string,&nbsp;if&nbsp;possible&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;print&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;print&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;f&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;_&nbsp;-&gt;&nbsp;raise&nbsp;(No_printer&nbsp;nm)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Get&nbsp;data,&nbsp;as&nbsp;a&nbsp;string&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;gets&nbsp;data&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;(get&nbsp;data)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;schema&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;t&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Schema.add&nbsp;t&nbsp;nm&nbsp;sets&nbsp;gets&nbsp;extra&nbsp;help\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;()\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end;\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&nbsp;&nbsp;=&nbsp;set;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get&nbsp;&nbsp;&nbsp;=&nbsp;get;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sets&nbsp;&nbsp;=&nbsp;sets;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gets&nbsp;&nbsp;=&nbsp;gets;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help&nbsp;&nbsp;=&nbsp;help;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extra&nbsp;=&nbsp;extra;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;fset&nbsp;data&nbsp;t&nbsp;?context&nbsp;x&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.set&nbsp;data&nbsp;?context&nbsp;x\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;fget&nbsp;data&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.get&nbsp;data\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;fsets&nbsp;data&nbsp;t&nbsp;?context&nbsp;s&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.sets&nbsp;data&nbsp;?context&nbsp;s\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;fgets&nbsp;data&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.gets&nbsp;data\n\n\&nbsp;&nbsp;end\n\n\&nbsp;&nbsp;module&nbsp;FieldRO&nbsp;=\n\&nbsp;&nbsp;struct\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;create&nbsp;?schema&nbsp;?name&nbsp;?parse&nbsp;?print&nbsp;?default&nbsp;?update&nbsp;?help&nbsp;extra&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;fld&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Field.create&nbsp;?schema&nbsp;?name&nbsp;?parse&nbsp;?print&nbsp;?default&nbsp;?update&nbsp;?help&nbsp;extra\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;data&nbsp;-&gt;&nbsp;Field.fget&nbsp;data&nbsp;fld\n\n\&nbsp;&nbsp;end\nend\n\nmodule&nbsp;OASISMessage&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISMessage.ml\"\n\n\n\&nbsp;&nbsp;open&nbsp;OASISGettext\n\&nbsp;&nbsp;open&nbsp;OASISContext\n\n\&nbsp;&nbsp;let&nbsp;generic_message&nbsp;~ctxt&nbsp;lvl&nbsp;fmt&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;cond&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ctxt.quiet&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;lvl&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Debug&nbsp;-&gt;&nbsp;ctxt.debug\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;`Info&nbsp;&nbsp;-&gt;&nbsp;ctxt.info\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;-&gt;&nbsp;true\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Printf.ksprintf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;str&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;cond&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ctxt.printf&nbsp;lvl&nbsp;str\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fmt\n\n\&nbsp;&nbsp;let&nbsp;debug&nbsp;~ctxt&nbsp;fmt&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;generic_message&nbsp;~ctxt&nbsp;`Debug&nbsp;fmt\n\n\&nbsp;&nbsp;let&nbsp;info&nbsp;~ctxt&nbsp;fmt&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;generic_message&nbsp;~ctxt&nbsp;`Info&nbsp;fmt\n\n\&nbsp;&nbsp;let&nbsp;warning&nbsp;~ctxt&nbsp;fmt&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;generic_message&nbsp;~ctxt&nbsp;`Warning&nbsp;fmt\n\n\&nbsp;&nbsp;let&nbsp;error&nbsp;~ctxt&nbsp;fmt&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;generic_message&nbsp;~ctxt&nbsp;`Error&nbsp;fmt\n\nend\n\nmodule&nbsp;OASISVersion&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISVersion.ml\"\n\n\&nbsp;&nbsp;open&nbsp;OASISGettext\n\n\n\n\&nbsp;&nbsp;type&nbsp;s&nbsp;=&nbsp;string\n\n\&nbsp;&nbsp;type&nbsp;t&nbsp;=&nbsp;string&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;comparator&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VGreater&nbsp;of&nbsp;t\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VGreaterEqual&nbsp;of&nbsp;t\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VEqual&nbsp;of&nbsp;t\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VLesser&nbsp;of&nbsp;t\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VLesserEqual&nbsp;of&nbsp;t\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VOr&nbsp;of&nbsp;&nbsp;comparator&nbsp;*&nbsp;comparator\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VAnd&nbsp;of&nbsp;comparator&nbsp;*&nbsp;comparator\n\&nbsp;&nbsp;&nbsp;&nbsp;\n\n\&nbsp;&nbsp;(*&nbsp;Range&nbsp;of&nbsp;allowed&nbsp;characters&nbsp;*)\n\&nbsp;&nbsp;let&nbsp;is_digit&nbsp;c&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;'0'&nbsp;&lt;=&nbsp;c&nbsp;&amp;&amp;&nbsp;c&nbsp;&lt;=&nbsp;'9'\n\n\&nbsp;&nbsp;let&nbsp;is_alpha&nbsp;c&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;('a'&nbsp;&lt;=&nbsp;c&nbsp;&amp;&amp;&nbsp;c&nbsp;&lt;=&nbsp;'z')&nbsp;||&nbsp;('A'&nbsp;&lt;=&nbsp;c&nbsp;&amp;&amp;&nbsp;c&nbsp;&lt;=&nbsp;'Z')\n\n\&nbsp;&nbsp;let&nbsp;is_special&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;function\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;'.'&nbsp;|&nbsp;'+'&nbsp;|&nbsp;'-'&nbsp;|&nbsp;'~'&nbsp;-&gt;&nbsp;true\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;-&gt;&nbsp;false\n\n\&nbsp;&nbsp;let&nbsp;rec&nbsp;version_compare&nbsp;v1&nbsp;v2&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;v1&nbsp;&lt;&gt;&nbsp;\"\"&nbsp;||&nbsp;v2&nbsp;&lt;&gt;&nbsp;\"\"&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Compare&nbsp;ascii&nbsp;string,&nbsp;using&nbsp;special&nbsp;meaning&nbsp;for&nbsp;version\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;related&nbsp;char\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;val_ascii&nbsp;c&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;c&nbsp;=&nbsp;'~'&nbsp;then&nbsp;-1\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;is_digit&nbsp;c&nbsp;then&nbsp;0\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;c&nbsp;=&nbsp;'\\000'&nbsp;then&nbsp;0\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;is_alpha&nbsp;c&nbsp;then&nbsp;Char.code&nbsp;c\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;(Char.code&nbsp;c)&nbsp;+&nbsp;256\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;len1&nbsp;=&nbsp;String.length&nbsp;v1&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;len2&nbsp;=&nbsp;String.length&nbsp;v2&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;p&nbsp;=&nbsp;ref&nbsp;0&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(**&nbsp;Compare&nbsp;ascii&nbsp;part&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;compare_vascii&nbsp;()&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;cmp&nbsp;=&nbsp;ref&nbsp;0&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;!cmp&nbsp;=&nbsp;0&nbsp;&amp;&amp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!p&nbsp;&lt;&nbsp;len1&nbsp;&amp;&amp;&nbsp;!p&nbsp;&lt;&nbsp;len2&nbsp;&amp;&amp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not&nbsp;(is_digit&nbsp;v1.[!p]&nbsp;&amp;&amp;&nbsp;is_digit&nbsp;v2.[!p])&nbsp;do\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmp&nbsp;:=&nbsp;(val_ascii&nbsp;v1.[!p])&nbsp;-&nbsp;(val_ascii&nbsp;v2.[!p]);\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incr&nbsp;p\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;!cmp&nbsp;=&nbsp;0&nbsp;&amp;&amp;&nbsp;!p&nbsp;&lt;&nbsp;len1&nbsp;&amp;&amp;&nbsp;!p&nbsp;=&nbsp;len2&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val_ascii&nbsp;v1.[!p]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;!cmp&nbsp;=&nbsp;0&nbsp;&amp;&amp;&nbsp;!p&nbsp;=&nbsp;len1&nbsp;&amp;&amp;&nbsp;!p&nbsp;&lt;&nbsp;len2&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;(val_ascii&nbsp;v2.[!p])\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!cmp\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(**&nbsp;Compare&nbsp;digit&nbsp;part&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;compare_digit&nbsp;()&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;extract_int&nbsp;v&nbsp;p&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;start_p&nbsp;=&nbsp;!p&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;!p&nbsp;&lt;&nbsp;String.length&nbsp;v&nbsp;&amp;&amp;&nbsp;is_digit&nbsp;v.[!p]&nbsp;do\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incr&nbsp;p\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;substr&nbsp;=&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.sub&nbsp;v&nbsp;!p&nbsp;((String.length&nbsp;v)&nbsp;-&nbsp;!p)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;res&nbsp;=&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;String.sub&nbsp;v&nbsp;start_p&nbsp;(!p&nbsp;-&nbsp;start_p)&nbsp;with&nbsp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;\"\"&nbsp;-&gt;&nbsp;0\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;s&nbsp;-&gt;&nbsp;int_of_string&nbsp;s\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res,&nbsp;substr\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;i1,&nbsp;tl1&nbsp;=&nbsp;extract_int&nbsp;v1&nbsp;(ref&nbsp;!p)&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;i2,&nbsp;tl2&nbsp;=&nbsp;extract_int&nbsp;v2&nbsp;(ref&nbsp;!p)&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i1&nbsp;-&nbsp;i2,&nbsp;tl1,&nbsp;tl2\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;compare_vascii&nbsp;()&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;0&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;compare_digit&nbsp;()&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;0,&nbsp;tl1,&nbsp;tl2&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;tl1&nbsp;&lt;&gt;&nbsp;\"\"&nbsp;&amp;&amp;&nbsp;is_digit&nbsp;tl1.[0]&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;tl2&nbsp;&lt;&gt;&nbsp;\"\"&nbsp;&amp;&amp;&nbsp;is_digit&nbsp;tl2.[0]&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version_compare&nbsp;tl1&nbsp;tl2\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;n,&nbsp;_,&nbsp;_&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;n&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\n\n\&nbsp;&nbsp;let&nbsp;version_of_string&nbsp;str&nbsp;=&nbsp;str\n\n\&nbsp;&nbsp;let&nbsp;string_of_version&nbsp;t&nbsp;=&nbsp;t\n\n\&nbsp;&nbsp;let&nbsp;chop&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;pos&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.rindex&nbsp;t&nbsp;'.'\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.sub&nbsp;t&nbsp;0&nbsp;pos\n\&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Not_found&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t\n\n\&nbsp;&nbsp;let&nbsp;rec&nbsp;comparator_apply&nbsp;v&nbsp;op&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;op&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VGreater&nbsp;cv&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(version_compare&nbsp;v&nbsp;cv)&nbsp;&gt;&nbsp;0\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VGreaterEqual&nbsp;cv&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(version_compare&nbsp;v&nbsp;cv)&nbsp;&gt;=&nbsp;0\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VLesser&nbsp;cv&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(version_compare&nbsp;v&nbsp;cv)&nbsp;&lt;&nbsp;0\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VLesserEqual&nbsp;cv&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(version_compare&nbsp;v&nbsp;cv)&nbsp;&lt;=&nbsp;0\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VEqual&nbsp;cv&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(version_compare&nbsp;v&nbsp;cv)&nbsp;=&nbsp;0\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VOr&nbsp;(op1,&nbsp;op2)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(comparator_apply&nbsp;v&nbsp;op1)&nbsp;||&nbsp;(comparator_apply&nbsp;v&nbsp;op2)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VAnd&nbsp;(op1,&nbsp;op2)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(comparator_apply&nbsp;v&nbsp;op1)&nbsp;&amp;&amp;&nbsp;(comparator_apply&nbsp;v&nbsp;op2)\n\n\&nbsp;&nbsp;let&nbsp;rec&nbsp;string_of_comparator&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;function\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VGreater&nbsp;v&nbsp;&nbsp;-&gt;&nbsp;\"&gt;&nbsp;\"^(string_of_version&nbsp;v)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VEqual&nbsp;v&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;\"=&nbsp;\"^(string_of_version&nbsp;v)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VLesser&nbsp;v&nbsp;&nbsp;&nbsp;-&gt;&nbsp;\"&lt;&nbsp;\"^(string_of_version&nbsp;v)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VGreaterEqual&nbsp;v&nbsp;-&gt;&nbsp;\"&gt;=&nbsp;\"^(string_of_version&nbsp;v)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VLesserEqual&nbsp;v&nbsp;&nbsp;-&gt;&nbsp;\"&lt;=&nbsp;\"^(string_of_version&nbsp;v)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VOr&nbsp;(c1,&nbsp;c2)&nbsp;&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(string_of_comparator&nbsp;c1)^\"&nbsp;||&nbsp;\"^(string_of_comparator&nbsp;c2)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VAnd&nbsp;(c1,&nbsp;c2)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(string_of_comparator&nbsp;c1)^\"&nbsp;&amp;&amp;&nbsp;\"^(string_of_comparator&nbsp;c2)\n\n\&nbsp;&nbsp;let&nbsp;rec&nbsp;varname_of_comparator&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;concat&nbsp;p&nbsp;v&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISUtils.varname_concat\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(OASISUtils.varname_of_string\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(string_of_version&nbsp;v))\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VGreater&nbsp;v&nbsp;-&gt;&nbsp;concat&nbsp;\"gt\"&nbsp;v\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VLesser&nbsp;v&nbsp;&nbsp;-&gt;&nbsp;concat&nbsp;\"lt\"&nbsp;v\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VEqual&nbsp;v&nbsp;&nbsp;&nbsp;-&gt;&nbsp;concat&nbsp;\"eq\"&nbsp;v\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VGreaterEqual&nbsp;v&nbsp;-&gt;&nbsp;concat&nbsp;\"ge\"&nbsp;v\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VLesserEqual&nbsp;v&nbsp;&nbsp;-&gt;&nbsp;concat&nbsp;\"le\"&nbsp;v\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VOr&nbsp;(c1,&nbsp;c2)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(varname_of_comparator&nbsp;c1)^\"_or_\"^(varname_of_comparator&nbsp;c2)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;VAnd&nbsp;(c1,&nbsp;c2)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(varname_of_comparator&nbsp;c1)^\"_and_\"^(varname_of_comparator&nbsp;c2)\n\n\&nbsp;&nbsp;let&nbsp;version_0_3_or_after&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;comparator_apply&nbsp;t&nbsp;(VGreaterEqual&nbsp;(string_of_version&nbsp;\"0.3\"))\n\nend\n\nmodule&nbsp;OASISExpr&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISExpr.ml\"\n\n\n\n\&nbsp;&nbsp;open&nbsp;OASISGettext\n\n\&nbsp;&nbsp;type&nbsp;test&nbsp;=&nbsp;string&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;flag&nbsp;=&nbsp;string&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;EBool&nbsp;of&nbsp;bool\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;ENot&nbsp;of&nbsp;t\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;EAnd&nbsp;of&nbsp;t&nbsp;*&nbsp;t\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;EOr&nbsp;of&nbsp;t&nbsp;*&nbsp;t\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;EFlag&nbsp;of&nbsp;flag\n\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;ETest&nbsp;of&nbsp;test&nbsp;*&nbsp;string\n\&nbsp;&nbsp;&nbsp;&nbsp;\n\n\&nbsp;&nbsp;type&nbsp;'a&nbsp;choices&nbsp;=&nbsp;(t&nbsp;*&nbsp;'a)&nbsp;list&nbsp;\n\n\&nbsp;&nbsp;let&nbsp;eval&nbsp;var_get&nbsp;t&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rec&nbsp;eval'&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;EBool&nbsp;b&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;ENot&nbsp;e&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not&nbsp;(eval'&nbsp;e)\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;EAnd&nbsp;(e1,&nbsp;e2)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(eval'&nbsp;e1)&nbsp;&amp;&amp;&nbsp;(eval'&nbsp;e2)\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;EOr&nbsp;(e1,&nbsp;e2)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(eval'&nbsp;e1)&nbsp;||&nbsp;(eval'&nbsp;e2)\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;EFlag&nbsp;nm&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;v&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var_get&nbsp;nm\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert(v&nbsp;=&nbsp;\"true\"&nbsp;||&nbsp;v&nbsp;=&nbsp;\"false\");\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(v&nbsp;=&nbsp;\"true\")\n\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;ETest&nbsp;(nm,&nbsp;vl)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;v&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var_get&nbsp;nm\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(v&nbsp;=&nbsp;vl)\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval'&nbsp;t\n\n\&nbsp;&nbsp;let&nbsp;choose&nbsp;?printer&nbsp;?name&nbsp;var_get&nbsp;lst&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rec&nbsp;choose_aux&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;(cond,&nbsp;vl)&nbsp;::&nbsp;tl&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;eval&nbsp;var_get&nbsp;cond&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vl\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;choose_aux&nbsp;tl\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;[]&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;str_lst&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;lst&nbsp;=&nbsp;[]&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s_&nbsp;\"&lt;empty&gt;\"\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.concat\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(s_&nbsp;\",&nbsp;\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(List.map\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;(cond,&nbsp;vl)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;printer&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;p&nbsp;-&gt;&nbsp;p&nbsp;vl\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;-&gt;&nbsp;s_&nbsp;\"&lt;no&nbsp;printer&gt;\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lst)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;name&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;nm&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;failwith\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Printf.sprintf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f_&nbsp;\"No&nbsp;result&nbsp;for&nbsp;the&nbsp;choice&nbsp;list&nbsp;'%s':&nbsp;%s\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nm&nbsp;str_lst)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;failwith\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Printf.sprintf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f_&nbsp;\"No&nbsp;result&nbsp;for&nbsp;a&nbsp;choice&nbsp;list:&nbsp;%s\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str_lst)\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;choose_aux&nbsp;(List.rev&nbsp;lst)\n\nend\n\nmodule&nbsp;OASISUnixPath&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISUnixPath.ml\"\n\n\&nbsp;&nbsp;type&nbsp;unix_filename&nbsp;=&nbsp;string\n\&nbsp;&nbsp;type&nbsp;unix_dirname&nbsp;=&nbsp;string\n\n\&nbsp;&nbsp;type&nbsp;host_filename&nbsp;=&nbsp;string\n\&nbsp;&nbsp;type&nbsp;host_dirname&nbsp;=&nbsp;string\n\n\&nbsp;&nbsp;let&nbsp;current_dir_name&nbsp;=&nbsp;\".\"\n\n\&nbsp;&nbsp;let&nbsp;parent_dir_name&nbsp;=&nbsp;\"..\"\n\n\&nbsp;&nbsp;let&nbsp;is_current_dir&nbsp;fn&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;fn&nbsp;=&nbsp;current_dir_name&nbsp;||&nbsp;fn&nbsp;=&nbsp;\"\"\n\n\&nbsp;&nbsp;let&nbsp;concat&nbsp;f1&nbsp;f2&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;is_current_dir&nbsp;f1&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f2\n\&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;f1'&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;OASISString.strip_ends_with&nbsp;~what:\"/\"&nbsp;f1&nbsp;with&nbsp;Not_found&nbsp;-&gt;&nbsp;f1\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f1'^\"/\"^f2\n\n\&nbsp;&nbsp;let&nbsp;make&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;function\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;hd&nbsp;::&nbsp;tl&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.fold_left\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;f&nbsp;p&nbsp;-&gt;&nbsp;concat&nbsp;f&nbsp;p)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hd\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tl\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;[]&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invalid_arg&nbsp;\"OASISUnixPath.make\"\n\n\&nbsp;&nbsp;let&nbsp;dirname&nbsp;f&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.sub&nbsp;f&nbsp;0&nbsp;(String.rindex&nbsp;f&nbsp;'/')\n\&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Not_found&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current_dir_name\n\n\&nbsp;&nbsp;let&nbsp;basename&nbsp;f&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;pos_start&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(String.rindex&nbsp;f&nbsp;'/')&nbsp;+&nbsp;1\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.sub&nbsp;f&nbsp;pos_start&nbsp;((String.length&nbsp;f)&nbsp;-&nbsp;pos_start)\n\&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Not_found&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f\n\n\&nbsp;&nbsp;let&nbsp;chop_extension&nbsp;f&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;last_dot&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.rindex&nbsp;f&nbsp;'.'\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;sub&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.sub&nbsp;f&nbsp;0&nbsp;last_dot\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;last_slash&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.rindex&nbsp;f&nbsp;'/'\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;last_slash&nbsp;&lt;&nbsp;last_dot&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Not_found&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub\n\n\&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Not_found&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f\n\n\&nbsp;&nbsp;let&nbsp;capitalize_file&nbsp;f&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;dir&nbsp;=&nbsp;dirname&nbsp;f&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;base&nbsp;=&nbsp;basename&nbsp;f&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;concat&nbsp;dir&nbsp;(String.capitalize&nbsp;base)\n\n\&nbsp;&nbsp;let&nbsp;uncapitalize_file&nbsp;f&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;dir&nbsp;=&nbsp;dirname&nbsp;f&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;base&nbsp;=&nbsp;basename&nbsp;f&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;concat&nbsp;dir&nbsp;(String.uncapitalize&nbsp;base)\n\nend\n\nmodule&nbsp;OASISHostPath&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISHostPath.ml\"\n\n\n\&nbsp;&nbsp;open&nbsp;Filename\n\n\&nbsp;&nbsp;module&nbsp;Unix&nbsp;=&nbsp;OASISUnixPath\n\n\&nbsp;&nbsp;let&nbsp;make&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;function\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;[]&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invalid_arg&nbsp;\"OASISHostPath.make\"\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;hd&nbsp;::&nbsp;tl&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.fold_left&nbsp;Filename.concat&nbsp;hd&nbsp;tl\n\n\&nbsp;&nbsp;let&nbsp;of_unix&nbsp;ufn&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Sys.os_type&nbsp;=&nbsp;\"Unix\"&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ufn\n\&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;make\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(List.map\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;p&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;p&nbsp;=&nbsp;Unix.current_dir_name&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current_dir_name\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;p&nbsp;=&nbsp;Unix.parent_dir_name&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent_dir_name\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(OASISString.nsplit&nbsp;ufn&nbsp;'/'))\n\n\nend\n\nmodule&nbsp;OASISExec&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISExec.ml\"\n\n\&nbsp;&nbsp;open&nbsp;OASISGettext\n\&nbsp;&nbsp;open&nbsp;OASISUtils\n\&nbsp;&nbsp;open&nbsp;OASISMessage\n\n\&nbsp;&nbsp;(*&nbsp;TODO:&nbsp;I&nbsp;don't&nbsp;like&nbsp;this&nbsp;quote,&nbsp;it&nbsp;is&nbsp;there&nbsp;because&nbsp;$(rm)&nbsp;foo&nbsp;expands&nbsp;to\n\&nbsp;&nbsp;&nbsp;*&nbsp;'rm&nbsp;-f'&nbsp;foo...\n\&nbsp;&nbsp;&nbsp;*)\n\&nbsp;&nbsp;let&nbsp;run&nbsp;~ctxt&nbsp;?f_exit_code&nbsp;?(quote=true)&nbsp;cmd&nbsp;args&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;cmd&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;quote&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Sys.os_type&nbsp;=&nbsp;\"Win32\"&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;String.contains&nbsp;cmd&nbsp;'&nbsp;'&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Double&nbsp;the&nbsp;1st&nbsp;double&nbsp;quote...&nbsp;win32...&nbsp;sigh&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\"\\\"\"^(Filename.quote&nbsp;cmd)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filename.quote&nbsp;cmd\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;cmdline&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.concat&nbsp;\"&nbsp;\"&nbsp;(cmd&nbsp;::&nbsp;args)\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;info&nbsp;~ctxt&nbsp;(f_&nbsp;\"Running&nbsp;command&nbsp;'%s'\")&nbsp;cmdline;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;f_exit_code,&nbsp;Sys.command&nbsp;cmdline&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None,&nbsp;0&nbsp;-&gt;&nbsp;()\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None,&nbsp;i&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;failwithf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f_&nbsp;\"Command&nbsp;'%s'&nbsp;terminated&nbsp;with&nbsp;error&nbsp;code&nbsp;%d\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmdline&nbsp;i\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;f,&nbsp;i&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;i\n\n\&nbsp;&nbsp;let&nbsp;run_read_output&nbsp;~ctxt&nbsp;?f_exit_code&nbsp;cmd&nbsp;args&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;fn&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filename.temp_file&nbsp;\"oasis-\"&nbsp;\".txt\"\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;()&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;run&nbsp;~ctxt&nbsp;?f_exit_code&nbsp;cmd&nbsp;(args&nbsp;@&nbsp;[\"&gt;\";&nbsp;Filename.quote&nbsp;fn])\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;chn&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open_in&nbsp;fn\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;routput&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ref&nbsp;[]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;true&nbsp;do\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;routput&nbsp;:=&nbsp;(input_line&nbsp;chn)&nbsp;::&nbsp;!routput\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;End_of_file&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;()\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close_in&nbsp;chn;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sys.remove&nbsp;fn;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.rev&nbsp;!routput\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;e&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(try&nbsp;Sys.remove&nbsp;fn&nbsp;with&nbsp;_&nbsp;-&gt;&nbsp;());\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;e\n\n\&nbsp;&nbsp;let&nbsp;run_read_one_line&nbsp;~ctxt&nbsp;?f_exit_code&nbsp;cmd&nbsp;args&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;run_read_output&nbsp;~ctxt&nbsp;?f_exit_code&nbsp;cmd&nbsp;args&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;[fst]&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fst\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;lst&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;failwithf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f_&nbsp;\"Command&nbsp;return&nbsp;unexpected&nbsp;output&nbsp;%S\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(String.concat&nbsp;\"\\n\"&nbsp;lst)\nend\n\nmodule&nbsp;OASISFileUtil&nbsp;=&nbsp;struct\n#&nbsp;21&nbsp;\"/home/gildor/tmp/oasis-mirror/src/oasis/OASISFileUtil.ml\"\n\n\&nbsp;&nbsp;open&nbsp;OASISGettext\n\n\&nbsp;&nbsp;let&nbsp;file_exists_case&nbsp;fn&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;dirname&nbsp;=&nbsp;Filename.dirname&nbsp;fn&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;basename&nbsp;=&nbsp;Filename.basename&nbsp;fn&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Sys.file_exists&nbsp;dirname&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;basename&nbsp;=&nbsp;Filename.current_dir_name&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;true\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.mem\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;basename\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Array.to_list&nbsp;(Sys.readdir&nbsp;dirname))\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false\n\n\&nbsp;&nbsp;let&nbsp;find_file&nbsp;?(case_sensitive=true)&nbsp;paths&nbsp;exts&nbsp;=\n\n\&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Cardinal&nbsp;product&nbsp;of&nbsp;two&nbsp;list&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;(&nbsp;*&nbsp;)&nbsp;lst1&nbsp;lst2&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.flatten\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(List.map\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;a&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.map\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;b&nbsp;-&gt;&nbsp;a,b)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lst2)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lst1)\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;rec&nbsp;combined_paths&nbsp;lst&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;lst&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;p1&nbsp;::&nbsp;p2&nbsp;::&nbsp;tl&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;acc&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(List.map\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;(a,b)&nbsp;-&gt;&nbsp;Filename.concat&nbsp;a&nbsp;b)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(p1&nbsp;*&nbsp;p2))\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_paths&nbsp;(acc&nbsp;::&nbsp;tl)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;[e]&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;[]&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;alternatives&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.map\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;(p,e)&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;String.length&nbsp;e&nbsp;&gt;&nbsp;0&nbsp;&amp;&amp;&nbsp;e.[0]&nbsp;&lt;&gt;&nbsp;'.'&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;^&nbsp;\".\"&nbsp;^&nbsp;e\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;^&nbsp;e)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((combined_paths&nbsp;paths)&nbsp;*&nbsp;exts)\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List.find\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(if&nbsp;case_sensitive&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_exists_case\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sys.file_exists)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alternatives\n\n\&nbsp;&nbsp;let&nbsp;which&nbsp;~ctxt&nbsp;prg&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;path_sep&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;Sys.os_type&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;\"Win32\"&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;';'\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;':'\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;path_lst&nbsp;=&nbsp;OASISString.nsplit&nbsp;(Sys.getenv&nbsp;\"PATH\")&nbsp;path_sep&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;exec_ext&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;Sys.os_type&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;\"Win32\"&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\"\"&nbsp;::&nbsp;(OASISString.nsplit&nbsp;(Sys.getenv&nbsp;\"PATHEXT\")&nbsp;path_sep)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[\"\"]\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;find_file&nbsp;~case_sensitive:false&nbsp;[path_lst;&nbsp;[prg]]&nbsp;exec_ext\n\n\&nbsp;&nbsp;(**/**)\n\&nbsp;&nbsp;let&nbsp;rec&nbsp;fix_dir&nbsp;dn&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;Windows&nbsp;hack&nbsp;because&nbsp;Sys.file_exists&nbsp;\"src\\\\\"&nbsp;=&nbsp;false&nbsp;when\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sys.file_exists&nbsp;\"src\"&nbsp;=&nbsp;true\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;ln&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.length&nbsp;dn\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Sys.os_type&nbsp;=&nbsp;\"Win32\"&nbsp;&amp;&amp;&nbsp;ln&nbsp;&gt;&nbsp;0&nbsp;&amp;&amp;&nbsp;dn.[ln&nbsp;-&nbsp;1]&nbsp;=&nbsp;'\\\\'&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fix_dir&nbsp;(String.sub&nbsp;dn&nbsp;0&nbsp;(ln&nbsp;-&nbsp;1))\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dn\n\n\&nbsp;&nbsp;let&nbsp;q&nbsp;=&nbsp;Filename.quote\n\&nbsp;&nbsp;(**/**)\n\n\&nbsp;&nbsp;let&nbsp;cp&nbsp;~ctxt&nbsp;?(recurse=false)&nbsp;src&nbsp;tgt&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;recurse&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;Sys.os_type&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;\"Win32\"&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISExec.run&nbsp;~ctxt\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\"xcopy\"&nbsp;[q&nbsp;src;&nbsp;q&nbsp;tgt;&nbsp;\"/E\"]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISExec.run&nbsp;~ctxt\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\"cp\"&nbsp;[\"-r\";&nbsp;q&nbsp;src;&nbsp;q&nbsp;tgt]\n\&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISExec.run&nbsp;~ctxt\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(match&nbsp;Sys.os_type&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;\"Win32\"&nbsp;-&gt;&nbsp;\"copy\"\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;-&gt;&nbsp;\"cp\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[q&nbsp;src;&nbsp;q&nbsp;tgt]\n\n\&nbsp;&nbsp;let&nbsp;mkdir&nbsp;~ctxt&nbsp;tgt&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;OASISExec.run&nbsp;~ctxt\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(match&nbsp;Sys.os_type&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;\"Win32\"&nbsp;-&gt;&nbsp;\"md\"\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;-&gt;&nbsp;\"mkdir\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[q&nbsp;tgt]\n\n\&nbsp;&nbsp;let&nbsp;rec&nbsp;mkdir_parent&nbsp;~ctxt&nbsp;f&nbsp;tgt&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;tgt&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fix_dir&nbsp;tgt\n\&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Sys.file_exists&nbsp;tgt&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;(Sys.is_directory&nbsp;tgt)&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISUtils.failwithf\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f_&nbsp;\"Cannot&nbsp;create&nbsp;directory&nbsp;'%s',&nbsp;a&nbsp;file&nbsp;of&nbsp;the&nbsp;same&nbsp;name&nbsp;already&nbsp;\\\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exists\")\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tgt\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkdir_parent&nbsp;~ctxt&nbsp;f&nbsp;(Filename.dirname&nbsp;tgt);\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;(Sys.file_exists&nbsp;tgt)&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;tgt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkdir&nbsp;~ctxt&nbsp;tgt\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\n\&nbsp;&nbsp;let&nbsp;rmdir&nbsp;~ctxt&nbsp;tgt&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Sys.readdir&nbsp;tgt&nbsp;=&nbsp;[||]&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;Sys.os_type&nbsp;with\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;\"Win32\"&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISExec.run&nbsp;~ctxt&nbsp;\"rd\"&nbsp;[q&nbsp;tgt]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OASISExec.run&nbsp;~ctxt&nbsp;\"rm\"&nbsp;[\"-r\";&nbsp;q&nbsp;tgt]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\n\&nbsp;&nbsp;let&nbsp;glob&nbsp;~ctxt&nbsp;fn&nbsp;=\n\&nbsp;&nbsp;&nbsp;let&nbsp;basename&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filename.basename&nbsp;fn\n\&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;String.length&nbsp;basename&nbsp;&gt;=&nbsp;2&nbsp;&amp;&amp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;basename.[0]&nbsp;=&nbsp;'*'&nbsp;&amp;&amp;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;basename.[1]&nbsp;=&nbsp;'.'&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;ext_len&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(String.length&nbsp;basename)&nbsp;-&nbsp;2\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;ext&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.sub&nbsp;basename&nbsp;2&nbsp;ext_len\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;dirname&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filename.dirname&nbsp;fn\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Array.fold_left\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;acc&nbsp;fn&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;fn_ext&nbsp;=\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.sub\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fn\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((String.length&nbsp;fn)&nbsp;-&nbsp;ext_len)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ext_len\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;fn_ext&nbsp;=&nbsp;ext&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Filename.concat&nbsp;dirname&nbsp;fn)&nbsp;::&nbsp;acc\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acc\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Invalid_argument&nbsp;_&nbsp;-&gt;\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acc)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Sys.readdir&nbsp;dirname)\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_exists_case&nbsp;fn&nbsp;then\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[fn]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]\n\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end\nend\n\n"</span></code></body></html>